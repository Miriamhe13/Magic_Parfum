!function(){var e={9577:function(e,t,i){"use strict";i.r(t);var s=i(1632);class n extends HTMLElement{static get observedAttributes(){return["refreshed-at"]}constructor(){super(),this.container=this.querySelector("[data-container]"),this.createPrimaryElement()}attributeChangedCallback(e,t,i){t!==i&&(this[e]=i,this.render())}connectedCallback(){this.style.display="none",this.orderLimitReached&&(s.m.removeItems(0),s.m.removeItems(this.storageKey)),this.inputTarget?.addEventListener("change",this.saveInputs.bind(this)),this.render()}disconnectedCallback(){this.inputTarget?.removeEventListener("change",this.saveInputs)}createPrimaryElement(){const e=document.createElement("label");e.setAttribute("data-order-limit-reached",this.orderLimitReached);const t=document.createElement("input");if(t.type="checkbox",t.checked=this.isChecked,t.value=this.defaultGiftOption.id,t.disabled=this.isDisabled,window.Wrapped.settings.block.gift_thumbnail_enabled){const t=document.createElement("img");t.setAttribute("src",window.Wrapped.giftOptionImage);const i=document.createElement("span");i.setAttribute("data-target","thumbnail"),i.appendChild(t),e.appendChild(i)}const i=document.createElement("span");i.innerHTML=this.inputLabel,this.orderLimitReached&&(i.innerHTML="ðŸŽ Gift options are unavailable. Contact us for details."),e.appendChild(t),e.appendChild(i),this.container.appendChild(e)}render(){this.skipRenderUpdate||this.hiddenCheckbox||(this.style.display="none","cart"===this.widgetType?this.renderCart():this.renderItem())}renderCart(){this.style.display="block"}renderItem(){this.style.display=this.isGift?"none":"block"}saveInputs(e){e.stopPropagation(),s.m.setItem(this.storageKey,"checked",e.target.checked),s.m.setItem(this.storageKey,"selected",e.target.value),s.m.setItem(this.storageKey,"claimed",this.widgetType),this.dispatchEvent(new CustomEvent("property:changed",{bubbles:!0,composed:!0,detail:{checked:e.target.checked,variant:Number(e.target.value)}})),this.parentElement.parentElement.dispatchEvent(new CustomEvent("giftOption:changed",{detail:{checked:e.target.checked,giftOptionId:e.target.value}}))}get orderLimitReached(){return window.Wrapped.settings.orders_limit_reached}get isDisabled(){return!!this.orderLimitReached||void 0===this.defaultGiftOption}get showPricing(){return window.Wrapped.settings.block.show_pricing}get inputLabel(){const e=this.getAttribute("input-label");return this.orderLimitReached?e:this.showPricing&&1===this.availableGiftOptions.length&&this.defaultGiftOption.price>0?`${e} <span class="pricing">${this.defaultGiftOption.formatted_price}</span>`:e}get inputTarget(){return this.querySelector("input")}get skipRenderUpdate(){return!this.hiddenCheckbox&&"true"===this.parentElement.parentElement.getAttribute("skip-render-update")}get hiddenCheckbox(){return"true"===this.parentElement.parentElement.getAttribute("hidden-checkbox")}get isChecked(){return"true"===this.parentElement.parentElement.getAttribute("is-checked")}get isGift(){return"true"===this.parentElement.parentElement.getAttribute("is-gift")}get widgetType(){return this.parentElement.parentElement.getAttribute("widget-type")}get storageKey(){return this.parentElement.parentElement.getAttribute("storage-key")}get giftOptionFilters(){return(this.parentElement.parentElement.getAttribute("gift-option-filters")||"")?.split(",").map((e=>Number(e)))}get availableGiftOptions(){return window.Wrapped.giftOptions.filter((e=>e.available))}get defaultGiftOption(){return this.availableGiftOptions.find((e=>e.available&&!this.giftOptionFilters.includes(e.id)))}}customElements.define("feature-checkbox",n)},7579:function(e,t,i){"use strict";i.r(t);var s=i(1632);class n extends HTMLElement{static get observedAttributes(){return["refreshed-at"]}constructor(){super(),this.container=this.querySelector("[data-container]"),this.createPrimaryElement()}attributeChangedCallback(e,t,i){t!==i&&(this[e]=i,this.render())}connectedCallback(){this.style.display="none",this.messageInput?.addEventListener("blur",this.saveInputs.bind(this)),this.messageInput?.addEventListener("change",this.saveInputs.bind(this)),this.messageInput?.addEventListener("input",this.saveInputs.bind(this)),this.render()}disconnectedCallback(){this.messageInput?.removeEventListener("blur",this.saveInputs),this.messageInput?.removeEventListener("input",this.saveInputs),this.messageInput?.removeEventListener("change",this.saveInputs)}createPrimaryElement(){const e=document.createElement("textarea");e.name="message",e.placeholder=this.placeholder,e.maxLength=this.maxLength,e.value=this.messageInputValue,e.disabled=!0;const t=document.createElement("span");t.setAttribute("data-target","counter"),this.container.appendChild(e),this.container.appendChild(t)}render(){this.messageEnabled?this.skipRenderUpdate||(this.style.display="none",this.messageInput.removeAttribute("disabled"),this.updateCounter(),this.style.display=this.isChecked?"block":"none",this.updateHasGiftMessage(this.messageInputValue)):this.remove()}updateCounter(){this.maxLength<=0||(this.counterTarget.textContent=`${this.messageInput.value.length} / ${this.maxLength}`)}updateHasGiftMessage(e){const t=!!e&&""!==e.trim();this.parentElement.parentElement.setAttribute("has-gift-message",t)}saveInputs(e){e.stopPropagation(),this.updateCounter(),this.updateHasGiftMessage(e.target.value),this.dispatchEvent(new CustomEvent("property:changed",{bubbles:!0,composed:!0,detail:{message:e.target.value}})),document.dispatchEvent(new CustomEvent("wrapped:cart:save",{detail:{identifier:this.tagName,widgetType:this.widgetType,name:e.target.name,value:e.target.value,storageKey:this.storageKey}}))}get skipRenderUpdate(){return"true"===this.parentElement.parentElement.getAttribute("skip-render-update")}get isChecked(){return"true"===this.parentElement.parentElement.getAttribute("is-checked")}get isGift(){return"true"===this.parentElement.parentElement.getAttribute("is-gift")}get widgetType(){return this.parentElement.parentElement.getAttribute("widget-type")}get storageKey(){return this.parentElement.parentElement.getAttribute("storage-key")}get messageInput(){return this.querySelector("textarea")}get counterTarget(){return this.querySelector('[data-target="counter"]')}get messageInputValue(){return s.m.getItem(this.storageKey,"message")||""}get maxLength(){return parseInt(this.parentElement.parentElement.getAttribute("message-max-length"))}get messageEnabled(){return"true"===this.parentElement.parentElement.getAttribute("message-enabled")}get placeholder(){return this.getAttribute("placeholder")}}customElements.define("feature-message",n)},4258:function(){const e=document.createElement("template");e.innerHTML=`\n<style type="text/css">\n  :host {\n    background-color: unset;\n    margin-bottom: var(--wrapped-feature-bottom-spacing);\n  }\n  :host label {\n    align-items: center;\n    color: var(--wrapped-powered-by-font-color, --wrapped-font-color);\n    cursor: pointer;\n    display: flex !important;\n    flex-flow: row;\n    font-size: var(--wrapped-font-size-smallest);\n    justify-content: flex-end;\n    line-height: normal;\n    letter-spacing: unset;\n    opacity: 0.8;\n    padding-left: 2.5em;\n    pointer-events: auto;\n    text-transform: none;\n    word-wrap: break-word;\n    visibility: visible;\n  }\n  :host a {\n    color: var(--wrapped-powered-by-font-color, --wrapped-font-color);\n\n    &:hover {\n      color: var(--wrapped-powered-by-font-color, --wrapped-font-color);\n    }\n  }\n</style>\n<div data-container>\n  <label part="label">\n    <span>\n      Gift options by\n      <a\n        href="https://apps.shopify.com/wrapped?utm_source=shopify&utm_medium=onlinestore&utm_campaign=poweredby&utm_content=${window.Shopify.shop}"\n        target="_blank"\n        rel="noopener external">Wrapped</a>\n    </span>\n  </label>\n</div>\n`;class t extends HTMLElement{static get observedAttributes(){return["refreshed-at"]}constructor(){super();const t=this.attachShadow({mode:"closed"}),i=e.content.cloneNode(!0);t.append(i)}attributeChangedCallback(e,t,i){t!==i&&(this[e]=i,this.render())}connectedCallback(){this.style.display="none",this.render()}render(){"true"!==this.isGift?this.style.display="block":this.style.display="none"}get isGift(){return this.parentElement.parentElement.getAttribute("is-gift")}}customElements.define("feature-powered-by",t)},1868:function(e,t,i){"use strict";i.r(t);var s=i(1632);class n extends HTMLElement{static get observedAttributes(){return["refreshed-at"]}constructor(){super(),this.container=this.querySelector("[data-container]"),this.createPrimaryElement()}attributeChangedCallback(e,t,i){t!==i&&(this[e]=i,this.render())}connectedCallback(){this.style.display="none",this.senderInput?.addEventListener("blur",this.saveInputs.bind(this)),this.senderInput?.addEventListener("change",this.saveInputs.bind(this)),this.senderInput?.addEventListener("input",this.saveInputs.bind(this)),this.recipientInput?.addEventListener("blur",this.saveInputs.bind(this)),this.recipientInput?.addEventListener("change",this.saveInputs.bind(this)),this.recipientInput?.addEventListener("input",this.saveInputs.bind(this)),this.render()}disconnectedCallback(){this.senderInput?.removeEventListener("blur",this.saveInputs),this.senderInput?.removeEventListener("input",this.saveInputs),this.recipientInput?.removeEventListener("blur",this.saveInputs),this.recipientInput?.removeEventListener("input",this.saveInputs)}createPrimaryElement(){const e=(e,t,i)=>{const s=document.createElement("div");s.setAttribute("data-target",e);const n=document.createElement("label");n.innerHTML=i;const r=document.createElement("input");return r.type="text",r.name=e,r.value=t,r.disabled=!0,s.appendChild(n),s.appendChild(r),s};if("receiver"!==this.senderReceiverFields){const t=e("sender",this.senderInputValue,this.senderLabel);this.container.appendChild(t)}if("sender"!==this.senderReceiverFields){const t=e("recipient",this.recipientInputValue,this.recipientLabel);this.container.appendChild(t)}}render(){this.senderReceiverEnabled?this.skipRenderUpdate||(this.style.display="none",this.senderInput&&this.senderInput.removeAttribute("disabled"),this.recipientInput&&this.recipientInput.removeAttribute("disabled"),this.style.display=this.isChecked?"block":"none",this.updateHasGiftSender(this.senderInputValue),this.updateHasGiftRecipient(this.recipientInputValue)):this.remove()}updateHasGiftSender(e){const t=!!e&&""!==e.trim();this.parentElement.parentElement.setAttribute("has-gift-sender",t)}updateHasGiftRecipient(e){const t=!!e&&""!==e.trim();this.parentElement.parentElement.setAttribute("has-gift-recipient",t)}saveInputs(e){e.stopPropagation(),"sender"===e.target.name&&this.updateHasGiftSender(e.target.value),"recipient"===e.target.name&&this.updateHasGiftRecipient(e.target.value);const t={};t[e.target.name]=e.target.value,this.dispatchEvent(new CustomEvent("property:changed",{bubbles:!0,composed:!0,detail:t})),document.dispatchEvent(new CustomEvent("wrapped:cart:save",{detail:{identifier:this.tagName,widgetType:this.widgetType,name:e.target.name,value:e.target.value,storageKey:this.storageKey}}))}get skipRenderUpdate(){return"true"===this.parentElement.parentElement.getAttribute("skip-render-update")}get isChecked(){return"true"===this.parentElement.parentElement.getAttribute("is-checked")}get isGift(){return"true"===this.parentElement.parentElement.getAttribute("is-gift")}get widgetType(){return this.parentElement.parentElement.getAttribute("widget-type")}get storageKey(){return this.parentElement.parentElement.getAttribute("storage-key")}get senderInputValue(){return s.m.getItem(this.storageKey,"sender")||""}get recipientInputValue(){return s.m.getItem(this.storageKey,"recipient")||""}get senderTarget(){return this.querySelector('[data-target="sender"]')}get senderLabel(){return this.getAttribute("sender-label")}get senderInput(){return this.senderTarget?.querySelector("input")}get recipientTarget(){return this.querySelector('[data-target="recipient"]')}get recipientLabel(){return this.getAttribute("recipient-label")}get recipientInput(){return this.recipientTarget?.querySelector("input")}get senderReceiverEnabled(){return"true"===this.parentElement.parentElement.getAttribute("sender-receiver-enabled")}get senderReceiverFields(){return this.parentElement.parentElement.getAttribute("sender-receiver-fields")}}customElements.define("feature-sender-recipient",n)},3082:function(e,t,i){"use strict";i.r(t);var s=i(1632);const n=document.createElement("template");n.innerHTML='\n<button type=\'button\' name=\'collapse-expand-button\'>\n  <span class="expanded">\n    <svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 2a8 8 0 100 16 8 8 0 000-16zM7.707 6.293a1 1 0 00-1.414 1.414L8.586 10l-2.293 2.293a1 1 0 101.414 1.414L10 11.414l2.293 2.293a1 1 0 101.414-1.414L11.414 10l2.293-2.293a1 1 0 00-1.414-1.414L10 8.586 7.707 6.293z" /></svg>\n  </span>\n  <span class="collapsed">\n    <svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-4.293-1.707a1 1 0 00-1.414 0L10 10.586 7.707 8.293a1 1 0 00-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 000-1.414z" /></svg>\n  </span>\n</button>\n';class r extends HTMLElement{static get observedAttributes(){return["refreshed-at"]}constructor(){super(),this.container=this.querySelector("[data-container]"),this.collapsed=s.m.getItem(this.storageKey,"variants:collapsed")||!1,this.setAttribute("selector-type",this.selectorType),this.createPrimaryElement()}attributeChangedCallback(e,t,i){t!==i&&(this[e]=i,this.render())}connectedCallback(){this.style.display="none",this.selectorInput?.addEventListener("change",this.saveInputs.bind(this)),this.buttonTarget?.addEventListener("click",this.toggleCollapsed.bind(this)),this.render()}disconnectedCallback(){this.selectorInput?.removeEventListener("change",this.saveInputs),this.buttonTarget?.removeEventListener("click",this.toggleCollapsed)}createPrimaryElement(){this.giftOptions.length<=1||("select"===this.selectorType?this.createPrimaryElementSelect():this.createPrimaryElementFieldset())}createPrimaryElementSelect(){this.selectorInput=document.createElement("select"),this.selectorInput.setAttribute("name","selected"),this.selectorInput.disabled=this.accountLimited,this.giftOptions.forEach((e=>{const t=document.createElement("option");t.value=e.id,t.innerHTML=this.giftOptionTitle(e),t.selected=this.isSelected(e),t.disabled=this.giftOptionDisabled(e),t.setAttribute("data-available",e.available),t.setAttribute("data-filtered",this.giftOptionFiltered(e)),this.selectorInput.appendChild(t)})),this.container.appendChild(this.selectorInput)}createPrimaryElementFieldset(){this.selectorInput=document.createElement("fieldset"),this.selectorInput.setAttribute("name","selected"),this.selectorInput.appendChild(n.cloneNode(!0).content),this.giftOptions.forEach((e=>{const t=document.createElement("label");t.setAttribute("data-variant-id",e.id),t.setAttribute("data-available",e.available),t.setAttribute("data-selected",this.isSelected(e)),t.setAttribute("data-filtered",this.giftOptionFiltered(e));const i=document.createElement("input");if(i.type="radio",i.value=e.id,i.name=`gift-option-${this.storageKey}-${this.giftOptionId}-${this.tagName}`,i.checked=this.isSelected(e),i.disabled=this.giftOptionDisabled(e),"images"===this.selectorType){let t;window.Wrapped.giftOptionImage&&(t=window.Wrapped.giftOptionImage),e.featured_image&&(t=`${e.featured_image.src}&width=600`),t&&(i.style.backgroundImage=`url(${t})`)}const s=document.createElement("span");s.innerHTML=this.giftOptionTitle(e),t.appendChild(i),t.appendChild(s),this.selectorInput.appendChild(t)})),this.container.appendChild(this.selectorInput)}render(){this.skipRenderUpdate||!this.hiddenCheckbox&&!window.Wrapped.enabledFeatures["multiple-gift-options"]||(this.style.display="none","cart"===this.widgetType?this.renderCart():this.renderItem())}renderCart(){this.hiddenCheckbox?this.style.display="block":window.Wrapped.enabledWidgets["wrapped-item"]||window.Wrapped.enabledWidgets["wrapped-item-drawer"]||window.Wrapped.enabledWidgets["wrapped-product"]||(this.style.display=this.isChecked?"block":"none")}renderItem(){this.isGift||(this.hiddenCheckbox?this.style.display="block":this.style.display=this.isChecked?"block":"none")}saveInputs(e){e.stopPropagation(),s.m.setItem(this.storageKey,"checked",!0),s.m.setItem(this.storageKey,"selected",e.target.value),s.m.setItem(this.storageKey,"claimed",this.widgetType),this.parentElement.parentElement.dispatchEvent(new CustomEvent("giftOption:changed",{detail:{checked:!0,giftOptionId:e.target.value}}))}toggleCollapsed(e){this.collapsed=!this.collapsed,s.m.setItem(this.storageKey,"variants:collapsed",this.collapsed)}isSelected(e){return Number(this.selectedOptionId)===Number(e.id)}giftOptionTitle(e){return this.showPricing&&0!==e.price?"images"===this.selectorType?`${e.title}<br><span class="pricing">${e.formatted_price}</span>`:`${e.title} <span class="pricing">${e.formatted_price}</span>`:e.title}giftOptionDisabled(e){return!!this.orderLimitReached||!!this.giftOptionFiltered(e)||!e.available}giftOptionFiltered(e){return this.giftOptionFilters.includes(Number(e.id))}get orderLimitReached(){return window.Wrapped.settings.orders_limit_reached}get inputLabel(){return this.orderLimitReached?"ðŸŽ Gift options are unavailable. Contact us for details.":this.getAttribute("input-label")}get showPricing(){return window.Wrapped.settings.block.show_pricing}set collapsed(e){this.setAttribute("collapsed",e)}get collapsed(){return"true"===this.getAttribute("collapsed")}get buttonTarget(){return this.querySelector('button[name="collapse-expand-button"]')}get skipRenderUpdate(){return!this.hiddenCheckbox&&"true"===this.parentElement.parentElement.getAttribute("skip-render-update")}get selectorType(){return this.parentElement.parentElement.getAttribute("selector-type")}get hiddenCheckbox(){return"true"===this.parentElement.parentElement.getAttribute("hidden-checkbox")}get isChecked(){return"true"===this.parentElement.parentElement.getAttribute("is-checked")}get isGift(){return"true"===this.parentElement.parentElement.getAttribute("is-gift")}get widgetType(){return this.parentElement.parentElement.getAttribute("widget-type")}get storageKey(){return this.parentElement.parentElement.getAttribute("storage-key")}get selectedOptionId(){return this.parentElement.parentElement.getAttribute("selected-option-id")}get giftOptionId(){return this.parentElement.parentElement.getAttribute("gift-option-id")}get giftOptionFilters(){return(this.parentElement.parentElement.getAttribute("gift-option-filters")||"")?.split(",").map((e=>Number(e)))}get giftOptions(){let e=window.Wrapped.giftOptions;if(window.Wrapped.enabledFeatures["multiple-gift-options"]||(e=[window.Wrapped.giftOptions.find((e=>e.available))]),this.hiddenCheckbox){let t={id:0,available:!0,price:0,formatted_price:"0",title:this.inputLabel,featured_image:null};window.Wrapped.giftOptionImage&&(t={...t,featured_image:{src:window.Wrapped.giftOptionImage}}),e=[t,...e]}return e}}customElements.define("feature-variants",r)},9181:function(e,t,i){"use strict";i.r(t);var s=i(5921);const n=(e,t)=>{e&&((e,t)=>{(0,s.debug)("event-ping",`pinging event: ${e}`);const i={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({event:{topic:e,shopify_domain:window.Wrapped.settings.shopify_domain,properties:t||{}}})},n=`${window.Wrapped.settings.host}/pings/events`;fetch(n,i)})(e,t)};class r extends HTMLElement{constructor(){super();const e=document.getElementById("wrapped-notifications-template");this.root=this.attachShadow({mode:"closed"}),this.root.append(e.content.cloneNode(!0)),this.titleTarget=this.root.querySelector('[data-target="title"]'),this.descriptionTarget=this.root.querySelector('[data-target="description"]'),this.ctaTarget=this.root.querySelector('[data-target="cta"]'),this.ctaSecondaryTarget=this.root.querySelector('[data-target="ctaSecondary"]'),this.dismissTarget=this.root.querySelector('[data-target="dismiss"]')}connectedCallback(){this.setupController()}ctaClicked(){n("theme editor notification",{type:"cta-clicked"}),window.open(`${this.ctaUrlValue}?theme-editor-notification=true`,"_blank")}ctaSecondaryClicked(){n("theme editor notification",{type:"cta-secondary-clicked"}),window.open(`${this.ctaSecondaryUrlValue}`,"_blank")}dismissClicked(){window.sessionStorage.setItem(`dismissed-${this.notificationCode}`,!0),n("Theme editor notification",{type:"dismissed"}),this.remove()}setupController(){if(this.notificationCode)if(window.sessionStorage.getItem(`dismissed-${this.notificationCode}`))this.remove();else switch(n("Theme editor notification",{type:this.notificationCode}),this.dismissTarget.addEventListener("click",this.dismissClicked.bind(this)),this.notificationCode){case"account-throttled":this.titleTarget.innerHTML="You have reached your account limit.",this.descriptionTarget.innerHTML="\n          Our system has detected you have reached the account limit on your current plan.\n          Please update your plan to increase all limits.\n        ",this.ctaTarget.style.display="block",this.ctaTarget.textContent="View plans",this.ctaTarget.addEventListener("click",this.ctaClicked.bind(this)),this.ctaUrlValue=window.Wrapped.settings.routes.billing_url,this.ctaSecondaryTarget.style.display="block",this.ctaSecondaryTarget.textContent="Learn more",this.ctaSecondaryTarget.addEventListener("click",this.ctaSecondaryClicked.bind(this)),this.ctaSecondaryUrlValue="https://help.alacartapps.co/article/30-understanding-eligible-plans-tailored-to-your-stores-needs",this.classList.add(this.appearClass);break;case"active-subscription-required":this.titleTarget.innerHTML="Get started with Wrapped!",this.descriptionTarget.innerHTML="\n          Please activate the Wrapped app to begin customizing gift options in the theme editor.\n        ",this.ctaTarget.style.display="block",this.ctaTarget.textContent="Activate Wrapped",this.ctaTarget.addEventListener("click",this.ctaClicked.bind(this)),this.ctaUrlValue=window.Wrapped.settings.routes.billing_url,this.classList.add(this.appearClass);break;case"theme-trial-unsupported":this.titleTarget.innerHTML="Theme trials are unsupported.",this.descriptionTarget.innerHTML="\n          Wrapped gift options (widgets) will not appear in theme trials until the theme is purchased or published.\n        ",this.classList.add(this.appearClass);break;case"orders-limit-reached":this.titleTarget.innerHTML="Your monthly order limit has been reached.",this.descriptionTarget.innerHTML="\n          Wrapped gift options are disabled until the beginning of next month.\n          Upgrade to a paid plan to enable gift options and receive unlimited orders.\n        ",this.ctaTarget.style.display="block",this.ctaTarget.textContent="View plans",this.ctaTarget.addEventListener("click",this.ctaClicked.bind(this)),this.ctaUrlValue=window.Wrapped.settings.routes.billing_url,this.classList.add(this.appearClass);break;default:this.remove()}else this.remove()}get appearClass(){return"Wrapped-Notification--appear"}get notificationCode(){return this.activeSubscriptionRequired()?"active-subscription-required":this.themeTrialUnsupported()?"theme-trial-unsupported":this.accountLimited()?"account-throttled":this.ordersLimitReached()?"orders-limit-reached":void 0}activeSubscriptionRequired(){return!1===window.Wrapped.settings.activated}themeTrialUnsupported(){return"demo"===window.Shopify?.theme?.role}accountLimited(){return window.Wrapped.settings.account_limited}ordersLimitReached(){return window.Wrapped.settings.orders_limit_reached}}customElements.define("wrapped-notification-controller",r)},9290:function(e,t,i){const{debugColor:s}=i(5921);i(5105),i(4551),i(7602),i(3728),i(7268),i(3157),i(4892),i(8953);class n extends HTMLElement{identifier="extension";DEFAULT_LOCALE="en";connectedCallback(){this.isRenderBlocked()?this.remove():(this.appendChild(this.provider),this.setAttribute("target-group",this.extension.targetGroup))}isRenderBlocked(){if(this.extension.giftOption&&0===window.Wrapped.giftOptions?.length)return s(this.identifier,"published gift option required"),!0}get provider(){return this._provider||(this._provider=document.createElement(`wrapped-${this.extension.kind}-provider`),this._provider.index=this.index,this._provider.extension=this.extension,this._provider.translations=this.translations),this._provider}get index(){return this.getAttribute("index")||0}get translations(){const e=window.Wrapped.settings.locale,t=window.Wrapped.settings.translations;return t[e]||t[this.DEFAULT_LOCALE]}}customElements.define("wrapped-extension",n)},3728:function(e,t,i){"use strict";i.r(t);var s=i(6911);const n=document.createElement("template");n.innerHTML='\n<div part="container">\n  <label>\n    <input type="checkbox" />\n    <span part="label"></span>\n    <span part="pricing"></span>\n  </label>\n</div>\n';class r extends HTMLElement{identifier="feature-checkbox-simple";connectedCallback(){this.appendChild(n.content.cloneNode(!0)),this.setDefaultAttributes(),this.setEventListeners()}setDefaultAttributes(){this.setAttribute("enabled",!0),this.setAttribute("part","feature"),this.setAttribute("feature","checkbox"),this.inputElement.value="yes",this.inputElement.checked=this.isChecked,this.inputElement.disabled=this.isDisabled,this.enabled&&(this.inputElement.name=this.inputElementName,this.extension.formTarget&&this.inputElement.setAttribute("form",this.extension.formTarget)),this.spanElement.innerHTML=this.spanElementValue,this.spanPricingElement.innerHTML=this.spanPricingElementValue}setEventListeners(){this.inputElement.addEventListener("change",this.onDataChange.bind(this))}onDataChange(e){e.stopPropagation(),this.provider.isChecked=e.target.checked,this.dispatchEvent(new CustomEvent("property:changed",{bubbles:!0,composed:!0,detail:{checked:e.target.checked}}))}resetInputs(){this.inputElement.checked=this.provider.isChecked=!1}get enabled(){return this.feature.enabled}get isChecked(){return this.provider.isChecked}set isChecked(e){this.inputElement.checked=e}get isDisabled(){return!!this.provider.ordersLimitReached}get inputElement(){return this.querySelector("label input")}get inputElementName(){return this.provider.fieldNameFor("checkbox")}get spanElement(){return this.querySelector('label span[part="label"]')}get spanElementValue(){return this.label}get spanPricingElement(){return this.querySelector('label span[part="pricing"]')}get spanPricingElementValue(){if(!this.showPricing)return"";const e=this.giftOptions[0];return 1===this.giftOptions.length&&e?.price>0?e.formatted_price:""}get showPricing(){return window.Wrapped.settings.block.show_pricing&&this.extension.giftOption&&!window.Wrapped.enabledFeatures["multiple-gift-options"]}get selectableGiftOptions(){let e=window.Wrapped.giftOptions||[];return e=e.filter((e=>e.available)),e=e.filter((e=>!s.q.isFilteredGiftOption(this.productId||0,e.id))),e}get giftOptions(){return this._giftOptions||(this._giftOptions=window.Wrapped.enabledFeatures["multiple-gift-options"]?this.selectableGiftOptions:this.selectableGiftOptions.slice(0,1)),this._giftOptions}get productId(){return this.parentElement?.productId}}customElements.define("wrapped-feature-checkbox-simple",r)},3157:function(){const e=document.createElement("template");e.innerHTML='\n<div part="container">\n  <textarea></textarea>\n  <span part="message-counter"></span>\n</div>\n';class t extends HTMLElement{identifier="feature-message-simple";connectedCallback(){this.appendChild(e.content.cloneNode(!0)),this.setDefaultAttributes(),this.setEventListeners(),this.updateCounter()}setDefaultAttributes(){this.setAttribute("enabled",this.enabled),this.setAttribute("part","feature"),this.setAttribute("feature","message"),this.textareaElement.placeholder=this.placeholder,this.textareaElement.maxLength=this.maxLength,this.textareaElement.value=this.messageValue,this.enabled&&(this.extension.formTarget&&this.textareaElement.setAttribute("form",this.extension.formTarget),this.handleFieldNames())}setEventListeners(){this.textareaElement.addEventListener("blur",this.onDataChange.bind(this)),this.textareaElement.addEventListener("change",this.onDataChange.bind(this)),this.textareaElement.addEventListener("input",this.onDataChange.bind(this))}onDataChange(e){e.stopPropagation(),this.messageValue!==e.target.value&&(this.messageValue=e.target.value,this.messageValue&&(this.provider.isChecked=!0),this.handleFieldNames(),this.dispatchEvent(new CustomEvent("property:changed",{bubbles:!0,composed:!0,detail:{message:e.target.value}})),this.updateCounter())}updateCounter(){const e=this.messageValue?.length||0;this.counterElement.textContent=`${e} / ${this.maxLength}`}resetInputs(){this.textareaElement.value=this.messageValue="",this.handleFieldNames(),this.updateCounter()}handleFieldNames(){this.messageValue?this.textareaElement.name=this.textareaElementName:this.textareaElement.removeAttribute("name")}get enabled(){return this.feature.enabled}get maxLength(){return parseInt(this.feature.maxLength||255)}get textareaElement(){return this.querySelector("textarea")}get textareaElementName(){return this.parentElement.fieldNameFor("message")}get counterElement(){return this.querySelector('span[part="message-counter"]')}}customElements.define("wrapped-feature-message-simple",t)},8953:function(){const e=document.createElement("template");e.innerHTML=`\n<div part="container">\n  <label>\n    <span>\n      Gift options by\n      <a\n        href="https://apps.shopify.com/wrapped?utm_source=shopify&utm_medium=onlinestore&utm_campaign=poweredby&utm_content=${window.Shopify.shop}"\n        target="_blank"\n        rel="noopener external">Wrapped</a>\n    </span>\n  </label>\n</div>\n`;class t extends HTMLElement{identifier="feature-powered-by-simple";connectedCallback(){this.appendChild(e.content.cloneNode(!0)),this.setDefaultAttributes(),this.setEventListeners()}setDefaultAttributes(){this.setAttribute("enabled",this.enabled),this.setAttribute("part","feature"),this.setAttribute("feature","powered-by")}setEventListeners(){}get enabled(){return this.feature.enabled}}customElements.define("wrapped-feature-powered-by-simple",t)},4892:function(){const e=document.createElement("template");e.innerHTML='\n<div part="container">\n  <div part="receiver">\n    <input type="text">\n  </div>\n  <div part="sender">\n    <input type="text">\n  </div>\n</div>\n';class t extends HTMLElement{identifier="feature-message-simple";connectedCallback(){this.appendChild(e.content.cloneNode(!0)),this.setDefaultAttributes(),this.setEventListeners()}setDefaultAttributes(){this.setAttribute("enabled",this.enabled),this.setAttribute("fields",this.displayFields),this.setAttribute("part","feature"),this.setAttribute("feature","sender-receiver"),this.senderElement.value=this.senderValue,this.senderElement.placeholder=this.senderLabel,this.receiverElement.value=this.receiverValue,this.receiverElement.placeholder=this.receiverLabel,this.enabled&&(this.extension.formTarget&&(this.senderElement.setAttribute("form",this.extension.formTarget),this.receiverElement.setAttribute("form",this.extension.formTarget)),this.handleFieldNames())}setEventListeners(){this.senderElement.addEventListener("blur",this.onDataChange.bind(this)),this.senderElement.addEventListener("change",this.onDataChange.bind(this)),this.senderElement.addEventListener("input",this.onDataChange.bind(this)),this.receiverElement.addEventListener("blur",this.onDataChange.bind(this)),this.receiverElement.addEventListener("change",this.onDataChange.bind(this)),this.receiverElement.addEventListener("input",this.onDataChange.bind(this))}onDataChange(e){e.stopPropagation();const t=this.senderValue!==this.senderElement.value,i=this.receiverValue!==this.receiverElement.value;(t||i)&&(this.senderValue=this.senderElement.value,this.receiverValue=this.receiverElement.value,this.senderValue&&(this.provider.isChecked=!0),this.receiverValue&&(this.provider.isChecked=!0),this.handleFieldNames(),this.dispatchEvent(new CustomEvent("property:changed",{bubbles:!0,composed:!0,detail:{sender:this.senderValue,receiver:this.receiverValue}})))}resetInputs(){this.senderElement.value=this.senderValue="",this.receiverElement.value=this.receiverValue="",this.handleFieldNames()}handleFieldNames(){this.senderValue?this.senderElement.name=this.senderElementName:this.senderElement.removeAttribute("name"),this.receiverValue?this.receiverElement.name=this.receiverElementName:this.receiverElement.removeAttribute("name")}get enabled(){return this.feature.enabled}get displayFields(){return this.feature.displayFields}get senderElement(){return this.querySelector('[part="sender"] input[type="text"]')}get receiverElement(){return this.querySelector('[part="receiver"] input[type="text"]')}get senderElementName(){return this.parentElement.fieldNameFor("sender")}get receiverElementName(){return this.parentElement.fieldNameFor("receiver")}}customElements.define("wrapped-feature-sender-receiver-simple",t)},7268:function(e,t,i){"use strict";i.r(t);var s=i(6911);const n=document.createElement("template");n.innerHTML='\n<div part="container">\n  <input type="hidden" part="name">\n  <input type="hidden" part="id">\n</div>\n';class r extends HTMLElement{identifier="feature-variant-simple";connectedCallback(){this.appendChild(n.content.cloneNode(!0)),this.setSelectedOption(this.selectedOptionName),this.createPrimaryElement(),this.setDefaultAttributes(),this.setEventListeners()}setDefaultAttributes(){this.setAttribute("enabled",this.enabled),this.setAttribute("part","feature"),this.setAttribute("feature","variant"),this.setAttribute("selector-type",this.selectorType),this.enabled&&(this.extension.formTarget&&(this.hiddenElement.setAttribute("form",this.extension.formTarget),this.hiddenElementId.setAttribute("form",this.extension.formTarget)),this.handleFieldNames())}setEventListeners(){this.choiceElement.addEventListener("change",this.onDataChange.bind(this))}onDataChange(e){if(e.stopPropagation(),Number(e.target.value)===this.selectedOptionId)return;const{name:t,sku:i}=this.giftOptions.find((t=>Number(t.id)===Number(e.target.value)));this.setSelectedOption(t),this.provider.isChecked=0!==Number(e.target.value),this.handleFieldNames(),this.dispatchEvent(new CustomEvent("property:changed",{bubbles:!0,composed:!0,detail:{checked:!0,variant:t,sku:i}}))}resetInputs(){this.selectedOptionId=null,this.selectedOptionName=null,this.hiddenElement.value=null,this.hiddenElementId.value=null,this.removeAttribute("selected-option-id"),this.handleFieldNames()}handleFieldNames(){this.selectedOptionName?this.hiddenElement.name=this.hiddenElementName:this.hiddenElement.removeAttribute("name"),this.selectedOptionId?this.hiddenElementId.name=this.hiddenElementIdName:this.hiddenElementId.removeAttribute("name")}setSelectedOption(e){const t=this.giftOptions.find((t=>t.name===e));t&&(this.selectedOptionId=t.id,this.selectedOptionName=t.name,this.hiddenElement.value=t.name,this.hiddenElementId.value=t.id,this.setAttribute("selected-option-id",this.selectedOptionId),this.handleFieldNames())}setDefaultOption(){this.selectedOptionId||this.defaultGiftOption&&(this.selectedOptionId=this.defaultGiftOption.id,this.selectedOptionName=this.defaultGiftOption.name,this.hiddenElement.value=this.defaultGiftOption.name,this.hiddenElementId.value=this.defaultGiftOption.id,this.setAttribute("selected-option-id",this.selectedOptionId),"FIELDSET"===this.choiceElement.tagName&&(this.choiceElement.querySelector(`input[value="${this.selectedOptionId}"]`).checked=!0),this.handleFieldNames())}createPrimaryElement(){"select"===this.selectorType?this.createPrimaryElementSelect():this.createPrimaryElementFieldset(),this.giftOptions.length<=1&&this.setAttribute("singular",!0)}createPrimaryElementSelect(){const e=document.createElement("select");this.giftOptions.forEach((t=>{const i=document.createElement("option");i.value=t.id,i.innerHTML=this.optionTitle(t),i.selected=this.isSelected(t),i.disabled=this.isOptionDisabled(t),i.setAttribute("data-available",t.available),i.setAttribute("data-filtered",this.isOptionFiltered(t)),e.appendChild(i)})),this.containerElement.appendChild(e)}createPrimaryElementFieldset(){const e=document.createElement("fieldset"),t=`${window.crypto.randomUUID()}-${this.tagName.toLowerCase()}`;this.giftOptions.forEach((i=>{const s=document.createElement("label");s.setAttribute("data-variant-id",i.id),s.setAttribute("data-available",i.available),s.setAttribute("data-selected",this.isSelected(i)),s.setAttribute("data-filtered",this.isOptionFiltered(i));const n=document.createElement("input");if(n.type="radio",n.value=i.id,n.name=t,n.checked=this.isSelected(i),n.disabled=this.isOptionDisabled(i),"images"===this.selectorType){let e;window.Wrapped.giftOptionImage&&(e=window.Wrapped.giftOptionImage),i.featured_image&&(e=`${i.featured_image.src}&width=600`),e&&(n.style.backgroundImage=`url(${e})`)}s.appendChild(n);const r=document.createElement("div");r.setAttribute("part","wrapper");const a=document.createElement("span");if(a.setAttribute("part","title"),a.innerHTML=i.title,r.appendChild(a),this.showPricing&&i.price>0){const e=document.createElement("span");e.setAttribute("part","pricing"),e.innerHTML=i.formatted_price,r.appendChild(e)}s.appendChild(r),e.appendChild(s)})),this.containerElement.appendChild(e)}isSelected(e){return Number(this.selectedOptionId)===Number(e.id)}isOptionDisabled(e){return!!this.isOptionFiltered(e)||!e.available}isOptionFiltered(e){return s.q.isFilteredGiftOption(this.productId,e.id)}optionTitle(e){return this.showPricing&&0!==e.price?`${e.title} ${e.formatted_price}`:e.title}get enabled(){return this.feature.enabled}get selectableGiftOptions(){let e=window.Wrapped.giftOptions||[];return e=e.filter((e=>e.available)),e=e.filter((e=>!s.q.isFilteredGiftOption(this.productId||0,e.id))),e}get giftOptions(){if(!this._giftOptions){let e=window.Wrapped.giftOptions||[];if(!window.Wrapped.enabledFeatures["multiple-gift-options"]){const t=this.selectableGiftOptions[0];t&&(e=[t])}if(this.hiddenCheckbox){void 0===this.selectedOptionId&&(this.selectedOptionId=0);let t={id:0,available:!0,price:0,formatted_price:"0",title:this.hiddenCheckboxLabel,name:this.hiddenCheckboxLabel,featured_image:null};window.Wrapped.giftOptionImage&&(t={...t,featured_image:{src:window.Wrapped.giftOptionImage}}),e=[t,...e]}this.defaultGiftOption=this.selectableGiftOptions[0],this._giftOptions=e}return this._giftOptions}get hiddenCheckbox(){return!1===this.extension.checkbox}get selectorType(){return this.extension.variantSelector}get containerElement(){return this.querySelector('div[part="container"]')}get hiddenElement(){return this.querySelector('input[type="hidden"][part="name"]')}get hiddenElementName(){return this.parentElement.fieldNameFor("variant")}get hiddenElementId(){return this.querySelector('input[type="hidden"][part="id"]')}get hiddenElementIdName(){return this.parentElement.fieldNameFor("variantId")}get choiceElement(){return this.querySelector("select")||this.querySelector("fieldset")}get productId(){return this.parentElement?.productId}get showPricing(){return window.Wrapped.settings.block.show_pricing}}customElements.define("wrapped-feature-variant-simple",r)},6911:function(e,t,i){"use strict";i.d(t,{q:function(){return s}});const s=(()=>{const e=e=>{const t={...window.Wrapped.settings.filters};return Object.prototype.hasOwnProperty.call(t,e)&&0===Object.keys(t[e]).length},t=(e,t)=>{const i={...window.Wrapped.settings.filters};return Object.prototype.hasOwnProperty.call(i,e)&&i[e].includes(t)};return{isFilteredProduct:t=>e(t),isFilteredGiftOption:(e,i)=>t(e,i),isFiltered:i=>{if(e(i))return!0;const s=window.Wrapped.giftOptions.map((e=>e.id));return 0!==s?.length&&s.every((e=>t(i,e)))}}})()},307:function(e,t,i){"use strict";i.d(t,{_:function(){return n}});var s=i(5921);const n={send:e=>{window.Wrapped.settings.block&&(e=>{(0,s.debugColor)("beacon",`beacon: ${e.extension.kind}`);const t=e.parentElement.parentElement.dataset;let i;const n=e.extension.kind===t.position,r=e.extension.kind===t.appBlock;if(n&&(i="data-position"),r&&(i="shopify-block"),!n&&!r&&(i="query-selector"),!window.sessionStorage.getItem("wrapped-beacon")||window.Shopify?.designMode){try{const t={method:"POST",headers:{"Content-Type":"application/json","X-Wrapped":!0,"X-Wrapped-Extension":e.extension.id,"X-Wrapped-Type":e.extension.kind,"X-Wrapped-Index":e.index},keepalive:!0,body:JSON.stringify({editor:window.Shopify?.designMode,version:window.Wrapped.version||"wrapped-0",widget:{id:e.extension.id,positioned_by:i,last_reported_selector:e.extension.target},theme:{id:window.Wrapped.theme.id,settings:window.Wrapped.settings.block,shopify:{...window.Shopify?.theme}},shop:window.Shopify?.shop})};fetch("https://beacons.wrapped.alacartapps.co/production/storefront",t)}catch(e){console.error(e)}window.sessionStorage.setItem("wrapped-beacon","true")}})(e)}}},4029:function(e,t,i){"use strict";i.d(t,{W:function(){return n}});var s=i(5921);const n=(()=>{const e="cart-api",t=e=>void 0===e?{"Content-Type":"application/json","X-Wrapped":!0}:{"Content-Type":"application/json","X-Wrapped":!0,"X-Wrapped-Extension":e.extension.id,"X-Wrapped-Type":e.extension.kind,"X-Wrapped-Index":e.index};return{fetchCart:async i=>{(0,s.debugColor)(e,"fetching cart");const n=(new Date).getTime();await fetch(`${window.Shopify.routes.root}cart.js?t=${n}`,{method:"GET",headers:t(i)}).then((e=>e.json())).then((t=>((0,s.debugColor)(e,"success",t),window.Wrapped.cart=t,t))).catch((e=>{(0,s.error)(e)}))},add:async(i,n)=>{(0,s.debugColor)(e,"add to cart",{data:i,caller:n}),await fetch(`${window.Shopify.routes.root}cart/add.js`,{method:"POST",headers:t(n),body:JSON.stringify(i)}).then((e=>e.json())).then((t=>((0,s.debugColor)(e,"success",t),t))).catch((e=>{(0,s.error)(e)}))},change:async(i,n)=>{(0,s.debugColor)(e,"changing cart",{data:i,caller:n}),await fetch(`${window.Shopify.routes.root}cart/change.js`,{method:"POST",headers:t(n),body:JSON.stringify(i)}).then((e=>e.json())).then((t=>((0,s.debugColor)(e,"success",t),window.Wrapped.cart=t,t))).catch((e=>{(0,s.error)(e)}))},update:async(i,n)=>{(0,s.debugColor)(e,"updating cart",{data:i,caller:n}),await fetch(`${window.Shopify.routes.root}cart/update.js`,{method:"POST",headers:t(n),body:JSON.stringify(i)}).then((e=>e.json())).then((t=>((0,s.debugColor)(e,"success",t),window.Wrapped.cart=t,t))).catch((e=>{(0,s.error)(e)}))}}})()},5105:function(e,t,i){"use strict";i.r(t);var s=i(307),n=i(4029),r=i(5921),a=i(2100),o=i(6911);class d extends HTMLElement{identifier="cart-line";constructor(){super(),this.saveRemoteData=(0,a.D)(this.saveRemoteData.bind(this),300)}connectedCallback(){this.isRenderBlocked()||((0,r.debugGroupCollapsed)(`${this.identifier} - ${this.index}`),(0,r.debugColor)(this.identifier,`connected - ${this.index}`,this),(0,r.debugColor)(this.identifier,"properties:",this.cartProperties),(0,r.debugGroupEnd)(`%c${this.identifier} - ${this.index}`),s._.send(this),this.appendChild(this.checkboxFeature),this.appendChild(this.variantFeature),this.appendChild(this.senderReceiverFeature),this.appendChild(this.messageFeature),this.appendChild(this.poweredByFeature),this.addEventListener("property:changed",this.propertyChangedListener.bind(this)),this.setDefaultAttributes())}disconnectedCallback(){(0,r.debugColor)(this.identifier,`disconnected - ${this.index}`)}isRenderBlocked(){return void 0===window.Wrapped.cart.items[this.index]||(this.isGiftOption?((0,r.debugColor)(this.identifier,`gift option - ${this.index}`),this.setAttribute("part","provider"),this.setAttribute("is-gift-option",!0),!0):!!this.isProductFiltered&&((0,r.debugColor)(this.identifier,`filtered - ${this.index}`),this.setAttribute("part","provider"),this.setAttribute("is-filtered",!0),!0))}setDefaultAttributes(){this.setAttribute("part","provider"),this.setAttribute("is-checked",this.isChecked),this.setAttribute("product-id",this.productId),this.setAttribute("variant-id",this.variantId),this.setAttribute("hidden-checkbox",this.hiddenCheckbox),this.setAttribute("has-gift-options",this.extension.giftOption),this.ordersLimitReached&&this.setAttribute("limited",!0)}async propertyChangedListener(e){this.purple&&(this.isChecked=!1,this.checkboxFeature.resetInputs(),this.variantFeature.resetInputs(),this.messageFeature.resetInputs(),this.senderReceiverFeature.resetInputs());const t={...this.cartProperties};switch(t[this.datafields.checkbox]=this.isChecked?"yes":"no",this.variantFeature.enabled&&this.isChecked?(this.variantFeature.setDefaultOption(),t[this.datafields.variant]=this.variantFeature.selectedOptionName||void 0,t[this.datafields.variantId]=this.variantFeature.selectedOptionId||void 0):(t[this.datafields.variant]=void 0,t[this.datafields.variantId]=void 0),this.messageFeature.enabled&&(t[this.datafields.message]=this.messageFeature.messageValue||void 0),this.senderReceiverFeature.enabled&&(t[this.datafields.receiver]=this.senderReceiverFeature.receiverValue||void 0,t[this.datafields.sender]=this.senderReceiverFeature.senderValue||void 0),e.detail.checked){case!0:case!1:this.saveRemoteDataNow(t).then((e=>this.triggerAction()));break;default:this.saveRemoteData(t)}}get purple(){return!this.extension.checkbox&&this.isChecked?!(this.variantFeature.selectedOptionName||this.messageFeature.messageValue||this.senderReceiverFeature.senderValue||this.senderReceiverFeature.receiverValue):!1===this.isChecked}saveRemoteData(e){const t={line:Number(this.index)+1,properties:e};n.W.change(t,this)}async saveRemoteDataNow(e){const t={line:Number(this.index)+1,properties:e};await n.W.change(t,this)}triggerAction(){switch(this.extension.actionType||"reload"){case"reload":this.actionReload();break;case"event":this.actionEvent();break;case"function":this.actionFunction();break;case"noop":this.actionNoop()}}actionReload(){(0,r.debugColor)(this.identifier,"action: reload"),window.location.reload()}actionEvent(){(0,r.debugColor)(this.identifier,"action: event");const e=new CustomEvent(this.extension.action,{detail:{cart:window.Wrapped.cart}});document.dispatchEvent(e),document.documentElement.dispatchEvent(e)}actionFunction(){(0,r.debugColor)(this.identifier,"action: function");try{Function(`"use strict"; return (${this.extension.action})`)()}catch(e){console.error("Wrapped: callback function error",e)}}actionNoop(){(0,r.debugColor)(this.identifier,"action: noop"),this.setAttribute("selected-option-id",this.variantFeature.selectedOptionId)}fieldNameFor(e){return`properties[${this.index}][${this.datafields[e]}]`}get checkboxFeature(){if(!this._checkboxFeature){const e={enabled:!0},t=document.createElement("wrapped-feature-checkbox-simple");t.provider=this,t.extension=this.extension,t.feature=e,t.label=this.checkboxLabel,this._checkboxFeature=t}return this._checkboxFeature}get variantFeature(){if(!this._variantFeature){const e={enabled:this.extension.giftOption},t=document.createElement("wrapped-feature-variant-simple");t.provider=this,t.extension=this.extension,t.feature=e,t.selectedOptionName=this.cartProperties[this.datafields.variant]||"",t.hiddenCheckboxLabel=this.translations.hidden_checkbox_label,this._variantFeature=t}return this._variantFeature}get senderReceiverFeature(){if(!this._senderReceiverFeature){const e={enabled:this.extension.senderReceiver,displayFields:this.extension.senderReceiverFields},t=document.createElement("wrapped-feature-sender-receiver-simple");t.provider=this,t.extension=this.extension,t.feature=e,t.senderValue=this.cartProperties[this.datafields.sender]||"",t.receiverValue=this.cartProperties[this.datafields.receiver]||"",t.senderLabel=this.translations.sender_label,t.receiverLabel=this.translations.recipient_label,this._senderReceiverFeature=t}return this._senderReceiverFeature}get messageFeature(){if(!this._messageFeature){const e={enabled:this.extension.message,maxLength:this.extension.messageMaxLength},t=document.createElement("wrapped-feature-message-simple");t.provider=this,t.extension=this.extension,t.feature=e,t.messageValue=this.cartProperties[this.datafields.message]||"",t.placeholder=this.translations.message_label,this._messageFeature=t}return this._messageFeature}get poweredByFeature(){if(!this._poweredByFeature){const e={enabled:this.extension.poweredBy},t=document.createElement("wrapped-feature-powered-by-simple");t.provider=this,t.extension=this.extension,t.feature=e,this._poweredByFeature=t}return this._poweredByFeature}get isChecked(){return void 0===this._isChecked&&(this.isChecked="yes"===this.cartProperties[this.datafields.checkbox]),this._isChecked}set isChecked(e){this.setAttribute("is-checked",e),this.checkboxFeature.isChecked=e,this._isChecked=e}get checkboxLabel(){return this.ordersLimitReached?"ðŸŽ Gift options are unavailable. Contact us for details.":this.translations.checkbox_label_cart}get ordersLimitReached(){return window.Wrapped.settings.orders_limit_reached}get hiddenCheckbox(){return!1===this.extension.checkbox&&!this.ordersLimitReached}get datafields(){return{...window.Wrapped.settings.datafields.properties,variantId:"_Gift Option ID"}}get cartLine(){return window.Wrapped.cart.items[this.index]}get cartProperties(){return{...this.cartLine?.properties}}get productId(){return this.cartLine?.product_id||0}get variantId(){return this.cartLine?.variant_id||0}get isGiftOption(){return window.Wrapped.giftOptions?.find((e=>e.id===this.variantId))}get isProductFiltered(){return o.q.isFilteredProduct(this.cartLine?.product_id)}}customElements.define("wrapped-cart-line-provider",d)},4551:function(e,t,i){"use strict";i.r(t);var s=i(307),n=i(4029),r=i(5921),a=i(2100);const o=(()=>{const e="fetch-intercept",t=e=>e.extension.giftOption&&"yes"===e.cartAttributes[e.datafields.checkbox],i=()=>{const e=window.Wrapped.giftOptions?.map((e=>e.id))||[],t=window.Wrapped.cart?.items?.find((t=>e.includes(t.id)));return!!t};return{intercept:s=>{if(window.Wrapped.settings.skip_fetch_interceptor)return;const{fetch:n}=window;window.fetch=async(...a)=>{const[o,d={}]=a;if(new Headers(d.headers).has("X-Wrapped"))return n(o,d);const c=await n(o,d),l={...window.Wrapped.cart};try{if(o.match("/cart/change")){(0,r.debugColor)(e,"intercepting: change",{caller:s});const n=c.clone();window.Wrapped.cart=await n.json(),await(async e=>{if(!t(e))return;if(i())return;const s=Object.keys(e.datafields).reduce(((t,i)=>(t[e.datafields[i]]=null,t)),{}),n={...e.cartAttributes,...s};await e.saveRemoteDataNow(n),window.Wrapped.buildExtensions(!0)})(s)}}catch(t){(0,r.error)(e,t),window.Wrapped.cart=l}return c}}}})(),d={intercept:async e=>{if(!(e=>e.extension.giftOption&&"yes"===e.cartAttributes[e.datafields.checkbox])(e))return;if((()=>{const e=window.Wrapped.giftOptions?.map((e=>e.id))||[],t=window.Wrapped.cart?.items?.find((t=>e.includes(t.id)));return!!t})())return;const t=Object.keys(e.datafields).reduce(((t,i)=>(t[e.datafields[i]]=null,t)),{}),i={...e.cartAttributes,...t};(0,r.debugColor)("page-intercept","gift option was removed externally"),await e.saveRemoteDataNow(i),window.Wrapped.buildExtensions(!0)}};class c extends HTMLElement{identifier="cart-list";constructor(){super(),this.saveRemoteData=(0,a.D)(this.saveRemoteData.bind(this),300)}connectedCallback(){this.isRenderBlocked()||((0,r.debugGroupCollapsed)(`${this.identifier} - ${this.index}`),(0,r.debugColor)(this.identifier,`connected - ${this.index}`,this),(0,r.debugColor)(this.identifier,"attributes:",this.cartAttributes),(0,r.debugGroupEnd)(`%c${this.identifier} - ${this.index}`),s._.send(this),this.appendChild(this.checkboxFeature),this.appendChild(this.variantFeature),this.appendChild(this.senderReceiverFeature),this.appendChild(this.messageFeature),this.appendChild(this.poweredByFeature),this.addEventListener("property:changed",this.propertyChangedListener.bind(this)),this.setDefaultAttributes(),o.intercept(this),d.intercept(this))}disconnectedCallback(){(0,r.debugColor)(this.identifier,`disconnected - ${this.index}`)}isRenderBlocked(){return this.index>0}setDefaultAttributes(){this.setAttribute("part","provider"),this.setAttribute("is-checked",this.isChecked),this.setAttribute("hidden-checkbox",this.hiddenCheckbox),this.setAttribute("has-gift-options",this.extension.giftOption),this.ordersLimitReached&&this.setAttribute("limited",!0)}async propertyChangedListener(e){this.purple&&(this.isChecked=!1,this.checkboxFeature.resetInputs(),this.variantFeature.resetInputs(),this.messageFeature.resetInputs(),this.senderReceiverFeature.resetInputs());const t={...this.cartAttributes};switch(t[this.datafields.checkbox]=this.isChecked?"yes":"no",t[this.datafields.message]=this.messageFeature.messageValue||null,t[this.datafields.receiver]=this.senderReceiverFeature.receiverValue||null,t[this.datafields.sender]=this.senderReceiverFeature.senderValue||null,this.variantFeature.enabled&&this.isChecked?(this.variantFeature.setDefaultOption(),t[this.datafields.variant]=this.variantFeature.selectedOptionName||null,t[this.datafields.variantId]=this.variantFeature.selectedOptionId||null):(t[this.datafields.variant]=null,t[this.datafields.variantId]=null),e.detail.checked){case!0:case!1:this.saveRemoteDataNow(t).then(this.optionallyCreateGiftOptions.bind(this)).then(this.optionallyDeleteGiftOptions.bind(this)).finally(this.triggerAction.bind(this));break;default:this.saveRemoteData(t)}}get purple(){return this.isChecked&&this.hiddenCheckbox?!(this.variantFeature.selectedOptionName||this.messageFeature.messageValue||this.senderReceiverFeature.senderValue||this.senderReceiverFeature.receiverValue):!1===this.isChecked}saveRemoteData(e){n.W.update({attributes:e},this)}async saveRemoteDataNow(e){await n.W.update({attributes:e},this)}async optionallyCreateGiftOptions(){if(!this.variantFeature.selectedOptionId)return;const e={items:[{id:this.variantFeature.selectedOptionId,quantity:1}]};await n.W.add(e,this)}async optionallyDeleteGiftOptions(){const e=window.Wrapped.giftOptions?.reduce(((e,t)=>(this.variantFeature.selectedOptionId===t.id||(e[t.id]=0),e)),{});await n.W.update({updates:e},this)}triggerAction(){switch(this.extension.actionType||"reload"){case"reload":this.actionReload();break;case"event":this.actionEvent();break;case"function":this.actionFunction();break;case"noop":this.actionNoop()}}actionReload(){(0,r.debugColor)(this.identifier,"action: reload"),window.location.reload()}actionEvent(){(0,r.debugColor)(this.identifier,"action: event");const e=new CustomEvent(this.extension.action,{detail:{cart:window.Wrapped.cart}});document.dispatchEvent(e),document.documentElement.dispatchEvent(e)}actionFunction(){(0,r.debugColor)(this.identifier,"action: function");try{Function(`"use strict"; return (${this.extension.action})`)()}catch(e){console.error("Wrapped: callback function error",e)}}actionNoop(){(0,r.debugColor)(this.identifier,"action: noop"),this.setAttribute("selected-option-id",this.variantFeature.selectedOptionId)}fieldNameFor(e){return`attributes[${this.datafields[e]}]`}get checkboxFeature(){if(!this._checkboxFeature){const e={enabled:!0},t=document.createElement("wrapped-feature-checkbox-simple");t.provider=this,t.extension=this.extension,t.feature=e,t.label=this.checkboxLabel,this._checkboxFeature=t}return this._checkboxFeature}get variantFeature(){if(!this._variantFeature){const e={enabled:this.extension.giftOption},t=document.createElement("wrapped-feature-variant-simple");t.provider=this,t.extension=this.extension,t.feature=e,t.selectedOptionName=this.cartAttributes[this.datafields.variant]||"",t.hiddenCheckboxLabel=this.translations.hidden_checkbox_label,this._variantFeature=t}return this._variantFeature}get senderReceiverFeature(){if(!this._senderReceiverFeature){const e={enabled:this.extension.senderReceiver,displayFields:this.extension.senderReceiverFields},t=document.createElement("wrapped-feature-sender-receiver-simple");t.provider=this,t.extension=this.extension,t.feature=e,t.senderValue=this.cartAttributes[this.datafields.sender]||"",t.receiverValue=this.cartAttributes[this.datafields.receiver]||"",t.senderLabel=this.translations.sender_label,t.receiverLabel=this.translations.recipient_label,this._senderReceiverFeature=t}return this._senderReceiverFeature}get messageFeature(){if(!this._messageFeature){const e={enabled:this.extension.message,maxLength:this.extension.messageMaxLength},t=document.createElement("wrapped-feature-message-simple");t.provider=this,t.extension=this.extension,t.feature=e,t.messageValue=this.cartAttributes[this.datafields.message]||"",t.placeholder=this.translations.message_label,this._messageFeature=t}return this._messageFeature}get poweredByFeature(){if(!this._poweredByFeature){const e={enabled:this.extension.poweredBy},t=document.createElement("wrapped-feature-powered-by-simple");t.provider=this,t.extension=this.extension,t.feature=e,this._poweredByFeature=t}return this._poweredByFeature}get isChecked(){return void 0===this._isChecked&&(this.isChecked="yes"===this.cartAttributes[this.datafields.checkbox]),this._isChecked}set isChecked(e){this.setAttribute("is-checked",e),this.checkboxFeature.isChecked=e,this._isChecked=e}get checkboxLabel(){return this.ordersLimitReached?"ðŸŽ Gift options are unavailable. Contact us for details.":this.translations.checkbox_label_cart}get ordersLimitReached(){return window.Wrapped.settings.orders_limit_reached}get hiddenCheckbox(){return!1===this.extension.checkbox&&!this.ordersLimitReached}get datafields(){return{...window.Wrapped.settings.datafields.attributes,variantId:"_Gift Option ID"}}get cartAttributes(){return{...window.Wrapped.cart.attributes}}}customElements.define("wrapped-cart-list-provider",c)},7602:function(e,t,i){"use strict";i.r(t);var s=i(307),n=i(5921),r=i(6911);class a extends HTMLElement{identifier="product";connectedCallback(){this.isRenderBlocked()||((0,n.debugColor)(this.identifier,`connected - ${this.index}`,this),s._.send(this),this.verifyFormTarget(),this.appendChild(this.checkboxFeature),this.appendChild(this.variantFeature),this.appendChild(this.senderReceiverFeature),this.appendChild(this.messageFeature),this.appendChild(this.poweredByFeature),this.addEventListener("property:changed",this.propertyChangedListener.bind(this)),this.setDefaultAttributes())}disconnectedCallback(){(0,n.debugColor)(this.identifier,`disconnected - ${this.index}`)}isRenderBlocked(){return this.index>0||!window.location.pathname.match("/products")||(this.isGiftOption?((0,n.debugColor)(this.identifier,`gift option - ${this.index}`),this.setAttribute("part","provider"),this.setAttribute("is-gift-option",!0),!0):!!this.isProductFiltered&&((0,n.debugColor)(this.identifier,`filtered - ${this.index}`),this.setAttribute("part","provider"),this.setAttribute("is-filtered",!0),!0))}verifyFormTarget(){if(this.extension.formTarget)return;if(this.closest('form[action*="/cart/add"'))return;const e=document.querySelector('form[action*="/cart/add"]:has(input[type="hidden"][name="id"]):has([type="submit"][name="add"])')||document.querySelector('form[action*="/cart/add"]:has(input[type="hidden"][name="id"]):has([type="submit"])');e&&(e.getAttribute("id")||e.setAttribute("id","wrapped-product-form"),this.extension.formTarget=e.getAttribute("id"))}setDefaultAttributes(){this.setAttribute("part","provider"),this.setAttribute("is-checked",this.isChecked),this.setAttribute("product-id",this.productId),this.setAttribute("variant-id",this.variantId),this.setAttribute("hidden-checkbox",this.hiddenCheckbox),this.setAttribute("has-gift-options",this.extension.giftOption),this.ordersLimitReached&&this.setAttribute("limited",!0)}propertyChangedListener(e){this.purple&&(this.isChecked=!1,this.checkboxFeature.resetInputs(),this.variantFeature.resetInputs(),this.messageFeature.resetInputs(),this.senderReceiverFeature.resetInputs()),this.variantFeature.enabled&&this.isChecked&&this.variantFeature.setDefaultOption()}get purple(){return this.isChecked&&this.hiddenCheckbox?!(this.variantFeature.selectedOptionName||this.messageFeature.messageValue||this.senderReceiverFeature.senderValue||this.senderReceiverFeature.receiverValue):!1===this.isChecked}fieldNameFor(e){return`properties[${this.datafields[e]}]`}get checkboxFeature(){if(!this._checkboxFeature){const e={enabled:!0},t=document.createElement("wrapped-feature-checkbox-simple");t.provider=this,t.extension=this.extension,t.feature=e,t.label=this.checkboxLabel,this._checkboxFeature=t}return this._checkboxFeature}get variantFeature(){if(!this._variantFeature){const e={enabled:this.extension.giftOption},t=document.createElement("wrapped-feature-variant-simple");t.provider=this,t.extension=this.extension,t.feature=e,t.hiddenCheckboxLabel=this.translations.hidden_checkbox_label,this._variantFeature=t}return this._variantFeature}get senderReceiverFeature(){if(!this._senderReceiverFeature){const e={enabled:this.extension.senderReceiver,displayFields:this.extension.senderReceiverFields},t=document.createElement("wrapped-feature-sender-receiver-simple");t.provider=this,t.extension=this.extension,t.feature=e,t.senderValue=null,t.receiverValue=null,t.senderLabel=this.translations.sender_label,t.receiverLabel=this.translations.recipient_label,this._senderReceiverFeature=t}return this._senderReceiverFeature}get messageFeature(){if(!this._messageFeature){const e={enabled:this.extension.message,maxLength:this.extension.messageMaxLength},t=document.createElement("wrapped-feature-message-simple");t.provider=this,t.extension=this.extension,t.feature=e,t.messageValue=null,t.placeholder=this.translations.message_label,this._messageFeature=t}return this._messageFeature}get poweredByFeature(){if(!this._poweredByFeature){const e={enabled:this.extension.poweredBy},t=document.createElement("wrapped-feature-powered-by-simple");t.provider=this,t.extension=this.extension,t.feature=e,this._poweredByFeature=t}return this._poweredByFeature}get isChecked(){return this._isChecked||!1}set isChecked(e){this.setAttribute("is-checked",e),this.checkboxFeature.isChecked=e,this._isChecked=e}get checkboxLabel(){return this.ordersLimitReached?"ðŸŽ Gift options are unavailable. Contact us for details.":this.translations.checkbox_label_cart}get ordersLimitReached(){return window.Wrapped.settings.orders_limit_reached}get hiddenCheckbox(){return!1===this.extension.checkbox&&!this.ordersLimitReached}get datafields(){return{...window.Wrapped.settings.datafields.properties,variantId:"_Gift Option ID"}}get productId(){return window.Wrapped?.selectedProductId||0}get variantId(){return window.Wrapped?.selectedVariantId||0}get isGiftOption(){return window.Wrapped.giftOptions?.find((e=>e.id===this.variantId))}get isProductFiltered(){return r.q.isFilteredProduct(window.Wrapped?.selectedProductId)}}customElements.define("wrapped-product-provider",a)},2100:function(e,t,i){"use strict";i.d(t,{D:function(){return s}});const s=(e,t)=>{let i;return(...s)=>{clearTimeout(i),i=setTimeout((()=>{e.apply(void 0,s)}),t)}}},1632:function(e,t,i){"use strict";i.d(t,{m:function(){return n}});var s=i(5921);const n=(()=>{const e="wrapped",t=window.localStorage,i=(e,i)=>{t.removeItem(`wrapped:${e}:${i}`)};return{hasSelections:i=>{const s=window.Wrapped.cart?.items.map((e=>e.id));return Object.entries(t).find((t=>{const[n,r]=t,a=n.startsWith(e)&&n.endsWith("selected"),o=Number(r)===i,d=s.includes(i);return a&&o&&d}))},setItem:(e,i,s)=>{((e,i,s)=>{t.setItem(`wrapped:${e}:${i}`,s)})(e,i,s)},getItem:(e,i)=>{const s=((e,i)=>t.getItem(`wrapped:${e}:${i}`))(e,i);switch(i){case"checked":return JSON.parse(s);case"selected":return Number(s);default:return s}},removeItems:e=>{i(e,"checked"),i(e,"selected"),i(e,"message"),i(e,"claimed"),i(e,"sender"),i(e,"recipient"),i(e,"variants:collapsed")},removeAllItems:()=>{Object.keys(t).forEach((i=>{i.startsWith(e)&&((0,s.debug)("local-storage",`removed: ${i}`),t.removeItem(i))}))}}})()},5921:function(e,t,i){"use strict";i.r(t),i.d(t,{debug:function(){return s},debugColor:function(){return n},debugGroupCollapsed:function(){return r},debugGroupEnd:function(){return a},error:function(){return o}});const s=(e,t,i)=>{window.Wrapped.settings?.debug&&(i?console.debug(`[${e}:${(new Date).getTime()}] ${t}`,i):console.debug(`[${e}:${(new Date).getTime()}] ${t}`))},n=(e,t,i,s="lime")=>{window.Wrapped.settings?.debug&&(i?console.debug(`%c[${e}:${(new Date).getTime()}] ${t}`,`color: ${s}`,i):console.debug(`%c[${e}:${(new Date).getTime()}] ${t}`,`color: ${s}`))},r=(e,t,i="lime")=>{window.Wrapped.settings?.debug&&(t?console.groupCollapsed(`%c[${e}]`,`color: ${i}`,t):console.groupCollapsed(`%c[${e}]`,`color: ${i}`))},a=(e,t,i="lime")=>{window.Wrapped.settings?.debug&&(t?console.groupEnd(`%c[${e}]`,`color: ${i}`,t):console.groupEnd(`%c[${e}]`,`color: ${i}`))},o=(e,t,i)=>{window.Wrapped.settings?.debug&&(i?console.error(`[${e}:${(new Date).getTime()}] ${t}`,i):console.error(`[${e}:${(new Date).getTime()}] ${t}`))}}},t={};function i(s){var n=t[s];if(void 0!==n)return n.exports;var r=t[s]={exports:{}};return e[s](r,r.exports,i),r.exports}i.d=function(e,t){for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},function(){"use strict";var e=i(5921),t=i(4029);i(9290),document.addEventListener("DOMContentLoaded",(()=>{if(0===window.Wrapped.extensions?.length)return;const i=(e,t)=>{const i=document.createElement("wrapped-extension");return i.setAttribute("uuid",e.id),i.setAttribute("index",t),i.extension=e,i},s=async(s=!1)=>{s?(0,e.debugColor)("document","rebuilding extensions..."):(0,e.debugColor)("document","building extensions..."),await t.W.fetchCart(),document.querySelectorAll("wrapped-extension").forEach((e=>e.remove())),window.Wrapped.extensions?.forEach((e=>{const t=document.querySelectorAll(`wrapped-extension-block[data-app-block="${e.kind}"]`);t.length>0?t.forEach(((t,s)=>{const n=i(e,s);t.insertAdjacentElement("afterbegin",n)})):document.querySelectorAll(e.target).forEach(((t,s)=>{const n=i(e,s);t.insertAdjacentElement(e.position,n)}))}))};new MutationObserver((t=>{const i=t.find((e=>Array.from(e.addedNodes).find((e=>window.Wrapped.extensions?.find((t=>e.querySelector&&e.querySelector(t.target))))))),n=t.find((e=>Array.from(e.removedNodes).find((e=>(e.nodeName,e.querySelector&&e.querySelector("wrapped-extension"))))));if(i)return(0,e.debugColor)("mutations","extension target added, rebuild queued"),void s(!0);n&&((0,e.debugColor)("mutations","extension removed, rebuild queued"),s(!0))})).observe(document.body,{attributes:!1,characterData:!1,childList:!0,subtree:!0}),s(),window.Wrapped.buildExtensions=s}));const s=(()=>{const t="cart-api",i=window.Shopify?.routes?.root||"/",s=i=>((0,e.debug)(t,JSON.stringify(i)),{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}),n=e=>{if(!e.ok)throw console.log("Wrapped: error communicating with Shopify cart - please contact support"),console.log(e.statusText),e;return e};return{fetch:async()=>{(0,e.debug)(t,"fetching");const s=(new Date).getTime(),r=[i,`cart.js?timestamp=${s}&wrapped=true`].join("");return await fetch(r).then(n).then((e=>e.json()))},add:async r=>{(0,e.debug)(t,"adding");const a=(new Date).getTime(),o=[i,`cart/add.js?timestamp=${a}&wrapped=true`].join("");return await fetch(o,s(r)).then(n).then((e=>e.json()))},change:async r=>{(0,e.debug)(t,"changing");const a=(new Date).getTime(),o=[i,`cart/change.js?timestamp=${a}&wrapped=true`].join("");return await fetch(o,s(r)).then(n).then((e=>e.json()))},update:async r=>{(0,e.debug)(t,"updating");const a=(new Date).getTime(),o=[i,`cart/update.js?timestamp=${a}&wrapped=true`].join("");return await fetch(o,s(r)).then(n).then((e=>e.json()))}}})();var n=i(1632);const r=(()=>{const t="cart-sweeper",i=window.Wrapped.giftOptions.map((e=>e.id));return{sweep:async()=>{(0,e.debug)(t,"sweeping gift items");const r={};i.forEach((e=>{n.m.hasSelections(e)||(r[e]=0)})),0!==Object.keys(r).length&&await s.update({updates:r}).then((i=>{void 0!==i&&((0,e.debug)(t,"results",i),window.Wrapped.cart=i)}))}}})(),a=(()=>{const e=()=>window.Wrapped.giftOptions.map((e=>e.id));return{checked:e=>n.m.getItem(e,"checked"),unchecked:e=>!n.m.getItem(e,"checked"),message:e=>n.m.getItem(e,"message"),sender:e=>n.m.getItem(e,"sender"),recipient:e=>n.m.getItem(e,"recipient"),option:e=>{const t=n.m.getItem(e,"selected");return window.Wrapped.giftOptions.find((e=>e.id===Number(t)))?.name},sku:e=>{const t=n.m.getItem(e,"selected");return window.Wrapped.giftOptions.find((e=>e.id===Number(t)))?.sku},isGift:t=>e().includes(Number(t)),isItem:t=>!e().includes(Number(t))}})(),o=(()=>{const e=e=>{const t=window.Wrapped.settings.filters;return Object.prototype.hasOwnProperty.call(t,e)&&0===Object.keys(t[e]).length},t=(e,t)=>{const i=window.Wrapped.settings.filters;return Object.prototype.hasOwnProperty.call(i,e)&&i[e].includes(t)};return{isFilteredProduct:t=>e(t),isFilteredGiftOption:(e,i)=>t(e,i),isFiltered:i=>!!e(i)||window.Wrapped.giftOptions.map((e=>e.id)).every((e=>t(i,e)))}})(),d=(()=>{const t="cart-storage-new-items",i=e=>{if(a.isGift(e.variant_id))return;if(o.isFilteredProduct(e.product_id))return;const t=e.properties?._WrappedId||e.variant_id;if(!window.Wrapped.enabledWidgets["wrapped-cart"]&&!window.Wrapped.enabledWidgets["wrapped-cart-drawer"])return;if(!n.m.getItem(0,"checked"))return;if(n.m.getItem(t,"checked"))return;const i=n.m.getItem(0,"selected");o.isFilteredGiftOption(e.product_id,i)||(n.m.setItem(t,"checked",!0),n.m.setItem(t,"selected",i),n.m.setItem(t,"claimed","cart"))};return{perform:()=>{(0,e.debug)(t,"performing"),window.Wrapped.cart?.items.forEach(i),(0,e.debug)(t,"performed")}}})(),c=(e,t)=>{if(e===t)return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;const i=Object.keys(e),s=Object.keys(t);if(i.length!==s.length)return!1;for(const s of i){if(!Object.prototype.hasOwnProperty.call(t,s))return!1;if(!c(e[s],t[s]))return!1}return!0},l=(e,t)=>!c(e,t),h=(()=>{const t=window.Wrapped.giftOptions.map((e=>e.id));return{quantities:()=>{(0,e.debug)("sync-order-mode","checking");const i=[],s=[];window.Wrapped.cart?.items.forEach((e=>{(t.includes(e.variant_id)?i:s).push(e)}));const r={updates:{}},a={updates:{}};i.forEach((e=>{const t=e.variant_id;r.updates[t]=e.quantity})),s.forEach((e=>{const t=e.properties?._WrappedId,i=e.variant_id,s=t||i;if(!n.m.getItem(s,"checked"))return;const r=n.m.getItem(s,"selected");r&&(a.updates[r]=1)})),Object.entries(r.updates).forEach((([e,t])=>{a.updates[e]||(a.updates[e]=0,n.m.removeItems(e))}));const o=!c(r,a);return[r,a,o]}}})(),u=(()=>{const t=window.Wrapped.giftOptions.map((e=>e.id));return{quantities:()=>{(0,e.debug)("sync-quantity-mode","checking");const i=[],s=[];window.Wrapped.cart?.items.forEach((e=>{(t.includes(e.variant_id)?i:s).push(e)}));const r={updates:{}},a={updates:{}};i.forEach((e=>{const t=e.variant_id;r.updates[t]=e.quantity})),s.forEach((e=>{const t=e.properties?._WrappedId,i=e.variant_id,s=t||i;if(!n.m.getItem(s,"checked"))return;const r=n.m.getItem(s,"selected");r&&(a.updates[r]=(a.updates[r]||0)+e.quantity)})),Object.entries(r.updates).forEach((([e,t])=>{a.updates[e]||(a.updates[e]=0,n.m.removeItems(e))}));const o=!c(r,a);return[r,a,o]}}})(),p=(()=>{const t=window.Wrapped.giftOptions.map((e=>e.id));return{quantities:()=>{(0,e.debug)("sync-sku-mode","checking");const i=[],s=[];window.Wrapped.cart?.items.forEach((e=>{(t.includes(e.variant_id)?i:s).push(e)}));const r={updates:{}},a={updates:{}};i.forEach((e=>{const t=e.variant_id;r.updates[t]=e.quantity})),s.forEach((e=>{const t=e.properties?._WrappedId,i=e.variant_id,s=t||i;if(!n.m.getItem(s,"checked"))return;const r=n.m.getItem(s,"selected");r&&(a.updates[r]=(a.updates[r]||0)+1)})),Object.entries(r.updates).forEach((([e,t])=>{a.updates[e]||(a.updates[e]=0,n.m.removeItems(e))}));const o=!c(r,a);return[r,a,o]}}})(),m=()=>{(0,e.debug)("sync-box-item-mode","checking");const t=[],i=[];window.Wrapped.cart?.items.forEach((e=>{(window.Wrapped.giftOptions.map((e=>e.id)).includes(e.variant_id)?t:i).push(e)}));const s={updates:{}},r={updates:{}};t.forEach((e=>{const t=e.variant_id;s.updates[t]=e.quantity})),i.forEach((e=>{const t=e.properties?._WrappedId,i=e.variant_id,s=t||i;if(!n.m.getItem(s,"checked"))return;const a=n.m.getItem(s,"selected");a&&(r.updates[a]=(r.updates[a]||0)+e.quantity)})),Object.entries(r.updates).forEach((([e,t])=>{const i=(s=e,window.Wrapped.giftOptions.find((e=>e.id===Number(s))));var s;const n=Math.ceil(t/i.box_item_limit||1);r.updates[e]=n})),Object.entries(s.updates).forEach((([e,t])=>{r.updates[e]||(r.updates[e]=0,n.m.removeItems(e))}));const a=!c(s,r);return[s,r,a]},g=()=>{(0,e.debug)("sync-box-weight-mode","checking");const t=[],i=[];window.Wrapped.cart?.items.forEach((e=>{(window.Wrapped.giftOptions.map((e=>e.id)).includes(e.variant_id)?t:i).push(e)}));const s={updates:{}},r={updates:{}};t.forEach((e=>{const t=e.variant_id;s.updates[t]=e.quantity})),i.forEach((e=>{const t=e.properties?._WrappedId,i=e.variant_id,s=t||i;if(!n.m.getItem(s,"checked"))return;const a=n.m.getItem(s,"selected");a&&(r.updates[a]=(r.updates[a]||0)+e.grams*e.quantity)})),Object.entries(r.updates).forEach((([e,t])=>{const i=(s=e,window.Wrapped.giftOptions.find((e=>e.id===Number(s))));var s;const n=Math.ceil(t/(1e3*i.box_weight_limit));r.updates[e]=n})),Object.entries(s.updates).forEach((([e,t])=>{r.updates[e]||(r.updates[e]=0,n.m.removeItems(e))}));const a=!c(s,r);return[s,r,a]},f=()=>{(0,e.debug)("sync-none-mode","checking");const t=[],i=[];window.Wrapped.cart?.items.forEach((e=>{(window.Wrapped.giftOptions.map((e=>e.id)).includes(e.variant_id)?t:i).push(e)}));const s={updates:{}},r={updates:{}};t.forEach((e=>{const t=e.variant_id;s.updates[t]=e.quantity})),i.forEach((e=>{const t=e.properties?._WrappedId,i=e.variant_id,a=t||i;if(!n.m.getItem(a,"checked"))return;const o=n.m.getItem(a,"selected");o&&(r.updates[o]=s.updates[o]||1)})),Object.entries(s.updates).forEach((([e,t])=>{r.updates[e]||(r.updates[e]=0,n.m.removeItems(e))}));const a=!c(s,r);return[s,r,a]},b=async()=>(window.Wrapped.cart&&0!==window.Wrapped.cart.length||await s.fetch().then((e=>{void 0!==e&&(window.Wrapped.cart=e)})),!(!window.Wrapped.cart.items||0===window.Wrapped.cart.items.length)&&window.Wrapped.cart.items.filter((e=>a.isItem(e.variant_id))).every((e=>o.isFiltered(e.product_id)))),v=()=>window.Wrapped.cart.items.every((e=>a.isGift(e.variant_id))),w="cart-sync",y=()=>{if((0,e.debug)(w,"checking quantities"),!Object.keys(window.Wrapped.enabledWidgets).length)return(0,e.debug)(w,"all widgets are off, skip sync"),!1;if(v()&&window.Wrapped.settings.buyable_gift_items)return(0,e.debug)(w,"buyable gift items: enabled"),!1;const[t,i,s]=(()=>{switch(window.Wrapped.settings.price_rule){case"order":return h.quantities();case"quantity":return u.quantities();case"sku":return p.quantities();case"box_item":return m();case"box_weight":return g();case"none":return f()}})();return(t=>{switch(t){case!0:(0,e.debug)(w,"sync required");break;case!1:(0,e.debug)(w,"all good")}})(s),s},E=(()=>{const t="cart-quantities";return{perform:async()=>{const[i,n,r]=(()=>{switch(window.Wrapped.settings.price_rule){case"order":return h.quantities();case"quantity":return u.quantities();case"sku":return p.quantities();case"box_item":return m();case"box_weight":return g();case"none":return f()}})();r&&((0,e.debug)(t,"performing"),await s.update(n).then((i=>{void 0!==i&&((0,e.debug)(t,"updated quantities"),window.Wrapped.cart=i,(0,e.debug)(t,"performed"))})))}}})(),k={perform:async()=>{(0,e.debug)("null-mode","no action performed")}},C=(()=>{const t="note-mode",i=()=>window.Wrapped.settings?.noteModeIgnoredFields||[];return{perform:async()=>{(0,e.debug)(t,"performing");const n=(()=>{const e=[];let t=1;return window.Wrapped.cart.items.forEach((s=>{const n=[];let r=null,d="";if(a.isGift(s.variant_id)){if(!window.Wrapped.enabledWidgets["wrapped-cart"]&&!window.Wrapped.enabledWidgets["wrapped-cart-drawer"])return;if(r=0,a.unchecked(r))return;d="**Wrapped Order**"}if(a.isItem(s.variant_id)){if(!window.Wrapped.enabledWidgets["wrapped-item"]&&!window.Wrapped.enabledWidgets["wrapped-item-drawer"]&&!window.Wrapped.enabledWidgets["wrapped-product"])return;if(o.isFilteredProduct(s.product_id))return;if(r=s.properties?._WrappedId||s.variant_id,a.unchecked(r))return;d=`**Wrapped Item ${t}**`,t++}n.push(`${d}`),s.sku&&!i().includes("product-sku")&&n.push(`Product SKU: ${s.sku}`),a.sku(r)&&!i().includes("gift-option-sku")&&n.push(`Gift Option SKU: ${a.sku(r)}`),a.recipient(r)&&!i().includes("recipient")&&n.push(`To: ${a.recipient(r)}`),a.sender(r)&&!i().includes("sender")&&n.push(`From: ${a.sender(r)}`),a.message(r)&&!i().includes("message")&&n.push(`\n${a.message(r)}`),1!==n.length&&e.push(n.join("\n"))})),e.join("\n")})();l(window.Wrapped.cart.note,n)?await s.update({note:n}).then((e=>{window.Wrapped.cart=e})):(0,e.debug)(t,"promises: skipped note"),(0,e.debug)(t,"performed")}}})(),A=(()=>{const t="attributes-mode",i=()=>({productTitle:"Title: {{value}}\r\n",productSku:"SKU: {{value}}\r\n",giftOption:"Option: {{value}}\r\n",message:"Message: {{value}}\r\n",recipient:"Recipient: {{value}}\r\n",sender:"Sender: {{value}}\r\n",...window.Wrapped.settings?.attributesModeTemplates}),n=()=>window.Wrapped.settings?.attributesModeIgnoreFields||[];return{perform:async()=>{(0,e.debug)(t,"performing");const r={...window.Wrapped.cart.attributes};Object.keys(r).forEach((e=>{e.startsWith("Wrapped ")&&(r[e]=null)}));let d=1;window.Wrapped.cart.items.forEach((e=>{let t=null,s="",c="";if(a.isGift(e.variant_id)){if(!window.Wrapped.enabledWidgets["wrapped-cart"]&&!window.Wrapped.enabledWidgets["wrapped-cart-drawer"])return;if(t=0,a.unchecked(t))return;c="Wrapped Order"}if(a.isItem(e.variant_id)){if(!window.Wrapped.enabledWidgets["wrapped-item"]&&!window.Wrapped.enabledWidgets["wrapped-item-drawer"]&&!window.Wrapped.enabledWidgets["wrapped-product"])return;if(o.isFilteredProduct(e.product_id))return;if(t=e.properties?._WrappedId||e.variant_id,a.unchecked(t))return;c=`Wrapped Item ${d}`,d++}s+=(e=>n().includes("product-title")?"":i().productTitle.replace("{{value}}",e.title))(e),s+=(e=>!e.sku||n().includes("product-sku")?"":i().productSku.replace("{{value}}",e.sku))(e),s+=((e,t)=>n().includes("gift-option")?"":i().giftOption.replace("{{value}}",a.option(t)))(0,t),s+=((e,t)=>n().includes("sender")?"":a.sender(t)?i().sender.replace("{{value}}",a.sender(t)):"")(0,t),s+=((e,t)=>n().includes("recipient")?"":a.recipient(t)?i().recipient.replace("{{value}}",a.recipient(t)):"")(0,t),s+=((e,t)=>n().includes("message")?"":a.message(t)?i().message.replace("{{value}}",a.message(t)):"")(0,t),s+="\r\n",r[c]=s})),l(window.Wrapped.cart.attributes,r)?await s.update({attributes:r}).then((e=>{window.Wrapped.cart=e})):(0,e.debug)(t,"promises: skipped"),(0,e.debug)(t,"performed")}}})(),O=(()=>{const t="properties-mode",i={OPTION:"Gift Option",SKU:"Gift Option SKU",MESSAGE:"Gift Message",SENDER:"Gift Sender",RECIPIENT:"Gift Recipient"},n=e=>{const t={...i,...window.Wrapped.settings?.KEYS||{}},s={...e.properties};a.isItem(e.variant_id)&&!s._WrappedId&&window.Wrapped.enabledFeatures["unique-line-items"]&&(s._WrappedId=window.crypto?.randomUUID().substring(0,8));const n=s._WrappedId,r=e.variant_id;let o=null;if(a.isGift(e.variant_id)){if(!window.Wrapped.enabledWidgets["wrapped-cart"]&&!window.Wrapped.enabledWidgets["wrapped-cart-drawer"])return s;o=0}if(a.isItem(e.variant_id)){if(!window.Wrapped.enabledWidgets["wrapped-item"]&&!window.Wrapped.enabledWidgets["wrapped-item-drawer"]&&!window.Wrapped.enabledWidgets["wrapped-product"])return s;o=n||r}if(a.checked(o)){const e=a.option(o),i=a.sku(o),n=a.message(o),r=a.sender(o),d=a.recipient(o);s[t.OPTION]=e,i?s[t.SKU]=i:delete s[t.SKU],n?s[t.MESSAGE]=n:delete s[t.MESSAGE],r?s[t.SENDER]=r:delete s[t.SENDER],d?s[t.RECIPIENT]=d:delete s[t.RECIPIENT]}if(a.unchecked(o)){for(const e of Object.values(t))delete s[e];!1===window.Wrapped.settings?.empty_properties&&(s[t.OPTION]="none")}return s};return{perform:async()=>{(0,e.debug)(t,"performing");const i=[];window.Wrapped.cart.items.forEach(((r,a)=>{i.push((async(i,r)=>{const a=`[${r}] ${i.title}`;if((0,e.debug)(t,`processing: ${a}`),o.isFilteredProduct(i.product_id))return"skipped-filtered";const d={line:r+1,properties:n(i),quantity:i.quantity};return c(d.properties,i.properties)?"done-equal-objects":0===Object.keys(d.properties).length&&null===i.properties?"done-equal-nulls":await s.change(d).then((i=>((0,e.debug)(t,`processed: ${a}`),window.Wrapped.cart=i,"resolved")))})(r,a))})),await Promise.all(i).then((i=>{(0,e.debug)(t,`promises: ${i}`)})),(0,e.debug)(t,"performed")}}})(),x=async()=>{const t="cart-data-strategy";if(!Object.keys(window.Wrapped.enabledWidgets).length)return(0,e.debug)(t,"all widgets are off, skip data"),!1;let i;switch((0,e.debug)(t,"performing"),window.Wrapped.settings.data_strategy){case"attributes":i=A;break;case"properties":i=O;break;default:i=k}await i.perform(),!0===window.Wrapped.settings.order_note_storage&&await C.perform(),(0,e.debug)(t,"performed")},F=e=>window.Wrapped.widgets.find((t=>e===t.widget||`wrapped-${e}`===t.widget)),I=(()=>{const t="cart-actions",i=()=>{window.location.reload()};return{perform:s=>{const n=F(s?.detail?.identifier);if(!n){const s=[window.Shopify.routes.root,"cart"].join("");return window.location.pathname.match(s)?((0,e.debug)(t,"action reloading (default)"),void i()):void(0,e.debug)(t,"action no-op (default)")}return n.actionEvent?((0,e.debug)(t,"action event"),void(e=>{const t=new CustomEvent(e,{detail:{cart:window.Wrapped.cart}});document.dispatchEvent(t),document.documentElement.dispatchEvent(t)})(n.actionEvent)):n.actionFunction?((0,e.debug)(t,"action function"),void(e=>{try{Function(`"use strict"; return (${e})`)()}catch(e){console.log("Wrapped: could not trigger function - please contact support")}})(n.actionFunction)):n.actionReload?((0,e.debug)(t,"action reloading"),void i()):void(0,e.debug)(t,"actions undefined")}}})(),W=(()=>{const t="cart",i=()=>{if(window.Wrapped.settings.skip_xhr_interceptor)return;const i=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(...s){const[n,r]=s;(r.match("/cart/add")||r.match("/cart/change")||r.match("/cart/update")||r.match("/cart/clear"))&&this.addEventListener("load",(()=>{(0,e.debug)(t,"intercepted xhr cart api"),document.dispatchEvent(new CustomEvent("wrapped:cart:verify")),document.dispatchEvent(new CustomEvent("wrapped:cart:intercept:xhr",{detail:{args:s}}))})),i.apply(this,s)}},a=async i=>{(0,e.debug)(t,"event: wrapped:cart:register"),await s.fetch().then((s=>{void 0!==s&&((0,e.debug)(t,"cart fetched",s),window.Wrapped.cart=s,document.dispatchEvent(new CustomEvent("wrapped:cart:items",{detail:{identifier:i?.detail?.identifier}})))}))},o=async i=>{(0,e.debug)(t,"event: wrapped:cart:verify"),await s.fetch().then((s=>{void 0!==s?c(window.Wrapped.cart,s)?(0,e.debug)(t,"cart response unchanged"):((0,e.debug)(t,"cart has changed"),(0,e.debug)(t,"old cart",window.Wrapped.cart),(0,e.debug)(t,"new cart",s),window.Wrapped.cart=s,document.dispatchEvent(new CustomEvent("wrapped:cart:items",{detail:{identifier:i?.detail?.identifier}}))):(0,e.debug)(t,"cart response empty")}))},l=async i=>{(0,e.debug)(t,"event: wrapped:cart:items"),await d.perform(),y()?(await E.perform(),await x(),await I.perform(i)):(await x(),document.dispatchEvent(new CustomEvent("wrapped:widget:refresh"))),document.dispatchEvent(new CustomEvent("wrapped:cart:updated",{detail:{cart:window.Wrapped.cart}}))},h=async i=>{if((0,e.debug)(t,"event: wrapped:cart:save"),n.m.setItem(i.detail.storageKey,i.detail.name,i.detail.value),"cart"===i.detail.widgetType){const e=n.m.getItem(i.detail.storageKey,"selected");n.m.setItem(e,i.detail.name,i.detail.value)}document.dispatchEvent(new CustomEvent("wrapped:cart:save:remote"))},u=async i=>{(0,e.debug)(t,"event: wrapped:cart:save:remote"),await x(),(0,e.debug)(t,"results",window.Wrapped.cart)},p=async i=>{if(window.Wrapped.settings.add_gift_event){if((0,e.debug)(t,"event: wrapped:cart:add_gift"),await r.sweep(),i.detail.checked&&0!==Number(i.detail.giftOptionId)){const e={items:[{id:i.detail.giftOptionId,quantity:1}]};await s.add(e),await s.fetch().then((e=>{void 0!==e&&(window.Wrapped.cart=e)}))}await x(),await I.perform(i),(0,e.debug)(t,"results",window.Wrapped.cart)}else(0,e.debug)(t,"event: wrapped:cart:add_gift is not enabled")},m=(e,t)=>{let i;return(...s)=>{clearTimeout(i),i=setTimeout((()=>{e.apply(void 0,s)}),t)}};return{initialize:()=>{(0,e.debug)(t,"starting"),(()=>{if(window.Wrapped.settings.skip_fetch_interceptor)return;const{fetch:i}=window;window.fetch=async(...s)=>{const[n,r]=s;try{n.match("wrapped=true")||(n.match("/cart/add")||n.match("/cart/change")||n.match("/cart/update")||n.match("/cart/clear"))&&((0,e.debug)(t,"intercepted pre-fetch cart api"),document.dispatchEvent(new CustomEvent("wrapped:cart:intercept:pre-fetch",{detail:{args:s}})))}catch(i){(0,e.error)(t,i)}const a=await i(n,r);try{if(!n.match("wrapped=true")&&(n.match("/cart/add")||n.match("/cart/change")||n.match("/cart/update")||n.match("/cart/clear"))){(0,e.debug)(t,"intercepted fetch cart api");const i={...window.Wrapped.cart};try{const e=a.clone();window.Wrapped.cart=await e.json()}catch(e){window.Wrapped.cart=i}document.dispatchEvent(new CustomEvent("wrapped:cart:verify")),document.dispatchEvent(new CustomEvent("wrapped:cart:intercept:fetch",{detail:{args:s}}))}}catch(i){(0,e.error)(t,i)}return a}})(),i(),document.addEventListener("wrapped:cart:register",m(a,0)),document.addEventListener("wrapped:cart:verify",m(o,250)),document.addEventListener("wrapped:cart:items",m(l,0)),document.addEventListener("wrapped:cart:save",m(h,0)),document.addEventListener("wrapped:cart:save:remote",m(u,400)),document.addEventListener("wrapped:cart:add_gift",m(p,0)),document.dispatchEvent(new CustomEvent("wrapped:cart:register")),0===window.Wrapped.cart?.item_count&&((0,e.debug)(t,"removing all entries from empty cart"),n.m.removeAllItems())}}})(),L=(()=>{const t="selector-observer",i={attributes:!1,characterData:!1,childList:!0,subtree:!0},s=e=>Array.from(document.querySelectorAll('[data-controller^="wrapped"]')).find((t=>t.contains(e))),n=i=>{!0===window.Wrapped.settings?.selector_observer_log_records&&(0,e.debug)(t,"showing records",i);for(const n of i){const i=s(n.target);if(i)return void(0,e.debug)(t,`${i?.dataset?.controller} is parent of target`)}window.Wrapped.widgets.forEach((s=>{const{widget:n,target:r,keyPrefix:a}=s;window.Wrapped.enabledWidgets[n]&&(document.querySelectorAll(`[data-controller="${n}"]`).forEach(((i,s)=>{i.dataset[`${a}IndexValue`]||((0,e.debug)(t,`${n} without index found in mutation`),i.dataset[`${a}IndexValue`]=s)})),i.find((i=>{const s=i.target.querySelector(`[data-position="${n}"]`),a=i.target.querySelector(r);return s?((0,e.debug)(t,`${n} data-position found in mutation`),document.dispatchEvent(new CustomEvent("wrapped:cart:verify")),document.dispatchEvent(new CustomEvent("wrapped:widget:setup")),!0):!!a&&((0,e.debug)(t,`${n} query-selector found in mutation`),document.dispatchEvent(new CustomEvent("wrapped:cart:verify")),document.dispatchEvent(new CustomEvent("wrapped:widget:setup")),!0)})))}))};return{initialize:()=>{!1!==window.Wrapped.settings?.selector_observer?((0,e.debug)(t,"starting"),new MutationObserver(n).observe(document.body,i)):(0,e.debug)(t,"selector observer is not enabled")}}})(),_=(()=>{const t=e=>{const t=Number(e.detail.giftOptionId)||void 0;Object.entries(window.localStorage).forEach((([e,i])=>{if(e.startsWith("wrapped:")&&e.endsWith("selected")&&Number(i)===t){const[,t]=e.split(":");n.m.removeItems(t)}}))};return{initialize:()=>{(0,e.debug)("storage","starting"),document.addEventListener("wrapped:storage:remove",t)}}})(),T=(()=>{const t="widgets",i=()=>{(0,e.debug)(t,"event: wrapped:widget:setup"),window.Wrapped.widgets.forEach(r)},s=()=>{(0,e.debug)(t,"event: wrapped:widget:refresh"),window.Wrapped.widgets.forEach(n)},n=e=>{const{widget:t,keyPrefix:i}=e;!0===window.Wrapped.enabledWidgets[t]&&document.querySelectorAll(`[data-controller="${t}"]`).forEach((e=>{e.dataset[`${i}TouchedAtValue`]=(new Date).getTime()}))},r=e=>{const{widget:t,target:i}=e;if(!0!==window.Wrapped.enabledWidgets[t])return;const s=document.querySelectorAll(`[data-position="${t}"]`);s.length?s.forEach(((t,i)=>{a(e,t,i,!0)})):i&&i.split(",").forEach((t=>{document.querySelectorAll(t).forEach(((i,s)=>{a(e,i,s,!1,t)}))}))},a=(i,s,n,r=!1,a)=>{const{widget:d,position:c,keyPrefix:l}=i;if("wrapped-item"===d&&void 0===window.Wrapped.cart?.items[n])return;let h=o(d,n);if(h)return h.dataset[`${l}IndexValue`]=n,void(0,e.debug)(t,`${d}: already added - ${n}`);h=document.createElement("div"),h.dataset.controller=d,h.dataset[`${l}IndexValue`]=n,h.dataset.selector=a,r?((0,e.debug)(t,`${d}: added via data-position - ${n}`),s.innerHTML=h.outerHTML):((0,e.debug)(t,`${d}: added via query-selector - ${n}`),s.insertAdjacentElement(c,h))},o=(e,t)=>document.querySelector(`[data-controller="${e}"][data-${e}-index-value="${t}"]`),d=(e,t)=>{let i,s,n=!1;const r=(...a)=>{if(n)return i=a,void(s=void 0);e.apply(void 0,a),n=!0,setTimeout((()=>{n=!1,i&&(r.apply(s,i),i=null,s=null)}),t)};return r};return{initialize:()=>{(0,e.debug)(t,"starting"),document.addEventListener("wrapped:widget:setup",d(i,10)),document.addEventListener("wrapped:widget:refresh",d(s,0)),document.dispatchEvent(new CustomEvent("wrapped:widget:setup"))}}})();if(!window.Wrapped?.version){const e=/\/(wrapped(?:-\w+)?-\d+)\//;try{Array.from(document.getElementsByTagName("script")).forEach((t=>{if(t.src){const i=t.src.match(e);i&&(window.Wrapped.version=i[1])}}))}catch(e){}}0===window.Wrapped?.extensions?.length&&(_.initialize(),T.initialize(),W.initialize(),L.initialize());class ${constructor(e,t,i){this.eventTarget=e,this.eventName=t,this.eventOptions=i,this.unorderedBindings=new Set}connect(){this.eventTarget.addEventListener(this.eventName,this,this.eventOptions)}disconnect(){this.eventTarget.removeEventListener(this.eventName,this,this.eventOptions)}bindingConnected(e){this.unorderedBindings.add(e)}bindingDisconnected(e){this.unorderedBindings.delete(e)}handleEvent(e){const t=function(e){if("immediatePropagationStopped"in e)return e;{const{stopImmediatePropagation:t}=e;return Object.assign(e,{immediatePropagationStopped:!1,stopImmediatePropagation(){this.immediatePropagationStopped=!0,t.call(this)}})}}(e);for(const e of this.bindings){if(t.immediatePropagationStopped)break;e.handleEvent(t)}}hasBindings(){return this.unorderedBindings.size>0}get bindings(){return Array.from(this.unorderedBindings).sort(((e,t)=>{const i=e.index,s=t.index;return i<s?-1:i>s?1:0}))}}class S{constructor(e){this.application=e,this.eventListenerMaps=new Map,this.started=!1}start(){this.started||(this.started=!0,this.eventListeners.forEach((e=>e.connect())))}stop(){this.started&&(this.started=!1,this.eventListeners.forEach((e=>e.disconnect())))}get eventListeners(){return Array.from(this.eventListenerMaps.values()).reduce(((e,t)=>e.concat(Array.from(t.values()))),[])}bindingConnected(e){this.fetchEventListenerForBinding(e).bindingConnected(e)}bindingDisconnected(e,t=!1){this.fetchEventListenerForBinding(e).bindingDisconnected(e),t&&this.clearEventListenersForBinding(e)}handleError(e,t,i={}){this.application.handleError(e,`Error ${t}`,i)}clearEventListenersForBinding(e){const t=this.fetchEventListenerForBinding(e);t.hasBindings()||(t.disconnect(),this.removeMappedEventListenerFor(e))}removeMappedEventListenerFor(e){const{eventTarget:t,eventName:i,eventOptions:s}=e,n=this.fetchEventListenerMapForEventTarget(t),r=this.cacheKey(i,s);n.delete(r),0==n.size&&this.eventListenerMaps.delete(t)}fetchEventListenerForBinding(e){const{eventTarget:t,eventName:i,eventOptions:s}=e;return this.fetchEventListener(t,i,s)}fetchEventListener(e,t,i){const s=this.fetchEventListenerMapForEventTarget(e),n=this.cacheKey(t,i);let r=s.get(n);return r||(r=this.createEventListener(e,t,i),s.set(n,r)),r}createEventListener(e,t,i){const s=new $(e,t,i);return this.started&&s.connect(),s}fetchEventListenerMapForEventTarget(e){let t=this.eventListenerMaps.get(e);return t||(t=new Map,this.eventListenerMaps.set(e,t)),t}cacheKey(e,t){const i=[e];return Object.keys(t).sort().forEach((e=>{i.push(`${t[e]?"":"!"}${e}`)})),i.join(":")}}const N={stop:({event:e,value:t})=>(t&&e.stopPropagation(),!0),prevent:({event:e,value:t})=>(t&&e.preventDefault(),!0),self:({event:e,value:t,element:i})=>!t||i===e.target},V=/^(?:(.+?)(?:\.(.+?))?(?:@(window|document))?->)?(.+?)(?:#([^:]+?))(?::(.+))?$/;function M(e){return e.replace(/(?:[_-])([a-z0-9])/g,((e,t)=>t.toUpperCase()))}function D(e){return M(e.replace(/--/g,"-").replace(/__/g,"_"))}function R(e){return e.charAt(0).toUpperCase()+e.slice(1)}function B(e){return e.replace(/([A-Z])/g,((e,t)=>`-${t.toLowerCase()}`))}const q={a:()=>"click",button:()=>"click",form:()=>"submit",details:()=>"toggle",input:e=>"submit"==e.getAttribute("type")?"click":"input",select:()=>"change",textarea:()=>"input"};function j(e){throw new Error(e)}function P(e){try{return JSON.parse(e)}catch(t){return e}}class G{constructor(e,t){this.context=e,this.action=t}get index(){return this.action.index}get eventTarget(){return this.action.eventTarget}get eventOptions(){return this.action.eventOptions}get identifier(){return this.context.identifier}handleEvent(e){this.willBeInvokedByEvent(e)&&this.applyEventModifiers(e)&&this.invokeWithEvent(e)}get eventName(){return this.action.eventName}get method(){const e=this.controller[this.methodName];if("function"==typeof e)return e;throw new Error(`Action "${this.action}" references undefined method "${this.methodName}"`)}applyEventModifiers(e){const{element:t}=this.action,{actionDescriptorFilters:i}=this.context.application;let s=!0;for(const[n,r]of Object.entries(this.eventOptions))if(n in i){const a=i[n];s=s&&a({name:n,value:r,event:e,element:t})}return s}invokeWithEvent(e){const{target:t,currentTarget:i}=e;try{const{params:s}=this.action,n=Object.assign(e,{params:s});this.method.call(this.controller,n),this.context.logDebugActivity(this.methodName,{event:e,target:t,currentTarget:i,action:this.methodName})}catch(t){const{identifier:i,controller:s,element:n,index:r}=this,a={identifier:i,controller:s,element:n,index:r,event:e};this.context.handleError(t,`invoking action "${this.action}"`,a)}}willBeInvokedByEvent(e){const t=e.target;return!(e instanceof KeyboardEvent&&this.action.isFilterTarget(e))&&(this.element===t||(t instanceof Element&&this.element.contains(t)?this.scope.containsElement(t):this.scope.containsElement(this.action.element)))}get controller(){return this.context.controller}get methodName(){return this.action.methodName}get element(){return this.scope.element}get scope(){return this.context.scope}}class K{constructor(e,t){this.mutationObserverInit={attributes:!0,childList:!0,subtree:!0},this.element=e,this.started=!1,this.delegate=t,this.elements=new Set,this.mutationObserver=new MutationObserver((e=>this.processMutations(e)))}start(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,this.mutationObserverInit),this.refresh())}pause(e){this.started&&(this.mutationObserver.disconnect(),this.started=!1),e(),this.started||(this.mutationObserver.observe(this.element,this.mutationObserverInit),this.started=!0)}stop(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)}refresh(){if(this.started){const e=new Set(this.matchElementsInTree());for(const t of Array.from(this.elements))e.has(t)||this.removeElement(t);for(const t of Array.from(e))this.addElement(t)}}processMutations(e){if(this.started)for(const t of e)this.processMutation(t)}processMutation(e){"attributes"==e.type?this.processAttributeChange(e.target,e.attributeName):"childList"==e.type&&(this.processRemovedNodes(e.removedNodes),this.processAddedNodes(e.addedNodes))}processAttributeChange(e,t){const i=e;this.elements.has(i)?this.delegate.elementAttributeChanged&&this.matchElement(i)?this.delegate.elementAttributeChanged(i,t):this.removeElement(i):this.matchElement(i)&&this.addElement(i)}processRemovedNodes(e){for(const t of Array.from(e)){const e=this.elementFromNode(t);e&&this.processTree(e,this.removeElement)}}processAddedNodes(e){for(const t of Array.from(e)){const e=this.elementFromNode(t);e&&this.elementIsActive(e)&&this.processTree(e,this.addElement)}}matchElement(e){return this.delegate.matchElement(e)}matchElementsInTree(e=this.element){return this.delegate.matchElementsInTree(e)}processTree(e,t){for(const i of this.matchElementsInTree(e))t.call(this,i)}elementFromNode(e){if(e.nodeType==Node.ELEMENT_NODE)return e}elementIsActive(e){return e.isConnected==this.element.isConnected&&this.element.contains(e)}addElement(e){this.elements.has(e)||this.elementIsActive(e)&&(this.elements.add(e),this.delegate.elementMatched&&this.delegate.elementMatched(e))}removeElement(e){this.elements.has(e)&&(this.elements.delete(e),this.delegate.elementUnmatched&&this.delegate.elementUnmatched(e))}}class U{constructor(e,t,i){this.attributeName=t,this.delegate=i,this.elementObserver=new K(e,this)}get element(){return this.elementObserver.element}get selector(){return`[${this.attributeName}]`}start(){this.elementObserver.start()}pause(e){this.elementObserver.pause(e)}stop(){this.elementObserver.stop()}refresh(){this.elementObserver.refresh()}get started(){return this.elementObserver.started}matchElement(e){return e.hasAttribute(this.attributeName)}matchElementsInTree(e){const t=this.matchElement(e)?[e]:[],i=Array.from(e.querySelectorAll(this.selector));return t.concat(i)}elementMatched(e){this.delegate.elementMatchedAttribute&&this.delegate.elementMatchedAttribute(e,this.attributeName)}elementUnmatched(e){this.delegate.elementUnmatchedAttribute&&this.delegate.elementUnmatchedAttribute(e,this.attributeName)}elementAttributeChanged(e,t){this.delegate.elementAttributeValueChanged&&this.attributeName==t&&this.delegate.elementAttributeValueChanged(e,t)}}function H(e,t){let i=e.get(t);return i||(i=new Set,e.set(t,i)),i}class z{constructor(){this.valuesByKey=new Map}get keys(){return Array.from(this.valuesByKey.keys())}get values(){return Array.from(this.valuesByKey.values()).reduce(((e,t)=>e.concat(Array.from(t))),[])}get size(){return Array.from(this.valuesByKey.values()).reduce(((e,t)=>e+t.size),0)}add(e,t){!function(e,t,i){H(e,t).add(i)}(this.valuesByKey,e,t)}delete(e,t){!function(e,t,i){H(e,t).delete(i),function(e,t){const i=e.get(t);null!=i&&0==i.size&&e.delete(t)}(e,t)}(this.valuesByKey,e,t)}has(e,t){const i=this.valuesByKey.get(e);return null!=i&&i.has(t)}hasKey(e){return this.valuesByKey.has(e)}hasValue(e){return Array.from(this.valuesByKey.values()).some((t=>t.has(e)))}getValuesForKey(e){const t=this.valuesByKey.get(e);return t?Array.from(t):[]}getKeysForValue(e){return Array.from(this.valuesByKey).filter((([t,i])=>i.has(e))).map((([e,t])=>e))}}class J{constructor(e,t,i,s={}){this.selector=t,this.details=s,this.elementObserver=new K(e,this),this.delegate=i,this.matchesByElement=new z}get started(){return this.elementObserver.started}start(){this.elementObserver.start()}pause(e){this.elementObserver.pause(e)}stop(){this.elementObserver.stop()}refresh(){this.elementObserver.refresh()}get element(){return this.elementObserver.element}matchElement(e){const t=e.matches(this.selector);return this.delegate.selectorMatchElement?t&&this.delegate.selectorMatchElement(e,this.details):t}matchElementsInTree(e){const t=this.matchElement(e)?[e]:[],i=Array.from(e.querySelectorAll(this.selector)).filter((e=>this.matchElement(e)));return t.concat(i)}elementMatched(e){this.selectorMatched(e)}elementUnmatched(e){this.selectorUnmatched(e)}elementAttributeChanged(e,t){const i=this.matchElement(e),s=this.matchesByElement.has(this.selector,e);!i&&s&&this.selectorUnmatched(e)}selectorMatched(e){this.delegate.selectorMatched&&(this.delegate.selectorMatched(e,this.selector,this.details),this.matchesByElement.add(this.selector,e))}selectorUnmatched(e){this.delegate.selectorUnmatched(e,this.selector,this.details),this.matchesByElement.delete(this.selector,e)}}class X{constructor(e,t){this.element=e,this.delegate=t,this.started=!1,this.stringMap=new Map,this.mutationObserver=new MutationObserver((e=>this.processMutations(e)))}start(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,{attributes:!0,attributeOldValue:!0}),this.refresh())}stop(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)}refresh(){if(this.started)for(const e of this.knownAttributeNames)this.refreshAttribute(e,null)}processMutations(e){if(this.started)for(const t of e)this.processMutation(t)}processMutation(e){const t=e.attributeName;t&&this.refreshAttribute(t,e.oldValue)}refreshAttribute(e,t){const i=this.delegate.getStringMapKeyForAttribute(e);if(null!=i){this.stringMap.has(e)||this.stringMapKeyAdded(i,e);const s=this.element.getAttribute(e);if(this.stringMap.get(e)!=s&&this.stringMapValueChanged(s,i,t),null==s){const t=this.stringMap.get(e);this.stringMap.delete(e),t&&this.stringMapKeyRemoved(i,e,t)}else this.stringMap.set(e,s)}}stringMapKeyAdded(e,t){this.delegate.stringMapKeyAdded&&this.delegate.stringMapKeyAdded(e,t)}stringMapValueChanged(e,t,i){this.delegate.stringMapValueChanged&&this.delegate.stringMapValueChanged(e,t,i)}stringMapKeyRemoved(e,t,i){this.delegate.stringMapKeyRemoved&&this.delegate.stringMapKeyRemoved(e,t,i)}get knownAttributeNames(){return Array.from(new Set(this.currentAttributeNames.concat(this.recordedAttributeNames)))}get currentAttributeNames(){return Array.from(this.element.attributes).map((e=>e.name))}get recordedAttributeNames(){return Array.from(this.stringMap.keys())}}class Y{constructor(e,t,i){this.attributeObserver=new U(e,t,this),this.delegate=i,this.tokensByElement=new z}get started(){return this.attributeObserver.started}start(){this.attributeObserver.start()}pause(e){this.attributeObserver.pause(e)}stop(){this.attributeObserver.stop()}refresh(){this.attributeObserver.refresh()}get element(){return this.attributeObserver.element}get attributeName(){return this.attributeObserver.attributeName}elementMatchedAttribute(e){this.tokensMatched(this.readTokensForElement(e))}elementAttributeValueChanged(e){const[t,i]=this.refreshTokensForElement(e);this.tokensUnmatched(t),this.tokensMatched(i)}elementUnmatchedAttribute(e){this.tokensUnmatched(this.tokensByElement.getValuesForKey(e))}tokensMatched(e){e.forEach((e=>this.tokenMatched(e)))}tokensUnmatched(e){e.forEach((e=>this.tokenUnmatched(e)))}tokenMatched(e){this.delegate.tokenMatched(e),this.tokensByElement.add(e.element,e)}tokenUnmatched(e){this.delegate.tokenUnmatched(e),this.tokensByElement.delete(e.element,e)}refreshTokensForElement(e){const t=this.tokensByElement.getValuesForKey(e),i=this.readTokensForElement(e),s=function(e,t){const i=Math.max(e.length,t.length);return Array.from({length:i},((i,s)=>[e[s],t[s]]))}(t,i).findIndex((([e,t])=>{return s=t,!((i=e)&&s&&i.index==s.index&&i.content==s.content);var i,s}));return-1==s?[[],[]]:[t.slice(s),i.slice(s)]}readTokensForElement(e){const t=this.attributeName;return function(e,t,i){return e.trim().split(/\s+/).filter((e=>e.length)).map(((e,s)=>({element:t,attributeName:i,content:e,index:s})))}(e.getAttribute(t)||"",e,t)}}class Z{constructor(e,t,i){this.tokenListObserver=new Y(e,t,this),this.delegate=i,this.parseResultsByToken=new WeakMap,this.valuesByTokenByElement=new WeakMap}get started(){return this.tokenListObserver.started}start(){this.tokenListObserver.start()}stop(){this.tokenListObserver.stop()}refresh(){this.tokenListObserver.refresh()}get element(){return this.tokenListObserver.element}get attributeName(){return this.tokenListObserver.attributeName}tokenMatched(e){const{element:t}=e,{value:i}=this.fetchParseResultForToken(e);i&&(this.fetchValuesByTokenForElement(t).set(e,i),this.delegate.elementMatchedValue(t,i))}tokenUnmatched(e){const{element:t}=e,{value:i}=this.fetchParseResultForToken(e);i&&(this.fetchValuesByTokenForElement(t).delete(e),this.delegate.elementUnmatchedValue(t,i))}fetchParseResultForToken(e){let t=this.parseResultsByToken.get(e);return t||(t=this.parseToken(e),this.parseResultsByToken.set(e,t)),t}fetchValuesByTokenForElement(e){let t=this.valuesByTokenByElement.get(e);return t||(t=new Map,this.valuesByTokenByElement.set(e,t)),t}parseToken(e){try{return{value:this.delegate.parseValueForToken(e)}}catch(e){return{error:e}}}}class Q{constructor(e,t){this.context=e,this.delegate=t,this.bindingsByAction=new Map}start(){this.valueListObserver||(this.valueListObserver=new Z(this.element,this.actionAttribute,this),this.valueListObserver.start())}stop(){this.valueListObserver&&(this.valueListObserver.stop(),delete this.valueListObserver,this.disconnectAllActions())}get element(){return this.context.element}get identifier(){return this.context.identifier}get actionAttribute(){return this.schema.actionAttribute}get schema(){return this.context.schema}get bindings(){return Array.from(this.bindingsByAction.values())}connectAction(e){const t=new G(this.context,e);this.bindingsByAction.set(e,t),this.delegate.bindingConnected(t)}disconnectAction(e){const t=this.bindingsByAction.get(e);t&&(this.bindingsByAction.delete(e),this.delegate.bindingDisconnected(t))}disconnectAllActions(){this.bindings.forEach((e=>this.delegate.bindingDisconnected(e,!0))),this.bindingsByAction.clear()}parseValueForToken(e){const t=class{constructor(e,t,i,s){this.element=e,this.index=t,this.eventTarget=i.eventTarget||e,this.eventName=i.eventName||function(e){const t=e.tagName.toLowerCase();if(t in q)return q[t](e)}(e)||j("missing event name"),this.eventOptions=i.eventOptions||{},this.identifier=i.identifier||j("missing identifier"),this.methodName=i.methodName||j("missing method name"),this.keyFilter=i.keyFilter||"",this.schema=s}static forToken(e,t){return new this(e.element,e.index,function(e){const t=e.trim().match(V)||[];let i=t[1],s=t[2];return s&&!["keydown","keyup","keypress"].includes(i)&&(i+=`.${s}`,s=""),{eventTarget:(n=t[3],"window"==n?window:"document"==n?document:void 0),eventName:i,eventOptions:t[6]?(r=t[6],r.split(":").reduce(((e,t)=>Object.assign(e,{[t.replace(/^!/,"")]:!/^!/.test(t)})),{})):{},identifier:t[4],methodName:t[5],keyFilter:s};var n,r}(e.content),t)}toString(){const e=this.keyFilter?`.${this.keyFilter}`:"",t=this.eventTargetName?`@${this.eventTargetName}`:"";return`${this.eventName}${e}${t}->${this.identifier}#${this.methodName}`}isFilterTarget(e){if(!this.keyFilter)return!1;const t=this.keyFilter.split("+"),i=["meta","ctrl","alt","shift"],[s,n,r,a]=i.map((e=>t.includes(e)));if(e.metaKey!==s||e.ctrlKey!==n||e.altKey!==r||e.shiftKey!==a)return!0;const o=t.filter((e=>!i.includes(e)))[0];return!!o&&(Object.prototype.hasOwnProperty.call(this.keyMappings,o)||j(`contains unknown key filter: ${this.keyFilter}`),this.keyMappings[o].toLowerCase()!==e.key.toLowerCase())}get params(){const e={},t=new RegExp(`^data-${this.identifier}-(.+)-param$`,"i");for(const{name:i,value:s}of Array.from(this.element.attributes)){const n=i.match(t),r=n&&n[1];r&&(e[M(r)]=P(s))}return e}get eventTargetName(){return(e=this.eventTarget)==window?"window":e==document?"document":void 0;var e}get keyMappings(){return this.schema.keyMappings}}.forToken(e,this.schema);if(t.identifier==this.identifier)return t}elementMatchedValue(e,t){this.connectAction(t)}elementUnmatchedValue(e,t){this.disconnectAction(t)}}class ee{constructor(e,t){this.context=e,this.receiver=t,this.stringMapObserver=new X(this.element,this),this.valueDescriptorMap=this.controller.valueDescriptorMap}start(){this.stringMapObserver.start(),this.invokeChangedCallbacksForDefaultValues()}stop(){this.stringMapObserver.stop()}get element(){return this.context.element}get controller(){return this.context.controller}getStringMapKeyForAttribute(e){if(e in this.valueDescriptorMap)return this.valueDescriptorMap[e].name}stringMapKeyAdded(e,t){const i=this.valueDescriptorMap[t];this.hasValue(e)||this.invokeChangedCallback(e,i.writer(this.receiver[e]),i.writer(i.defaultValue))}stringMapValueChanged(e,t,i){const s=this.valueDescriptorNameMap[t];null!==e&&(null===i&&(i=s.writer(s.defaultValue)),this.invokeChangedCallback(t,e,i))}stringMapKeyRemoved(e,t,i){const s=this.valueDescriptorNameMap[e];this.hasValue(e)?this.invokeChangedCallback(e,s.writer(this.receiver[e]),i):this.invokeChangedCallback(e,s.writer(s.defaultValue),i)}invokeChangedCallbacksForDefaultValues(){for(const{key:e,name:t,defaultValue:i,writer:s}of this.valueDescriptors)null==i||this.controller.data.has(e)||this.invokeChangedCallback(t,s(i),void 0)}invokeChangedCallback(e,t,i){const s=`${e}Changed`,n=this.receiver[s];if("function"==typeof n){const s=this.valueDescriptorNameMap[e];try{const e=s.reader(t);let r=i;i&&(r=s.reader(i)),n.call(this.receiver,e,r)}catch(e){throw e instanceof TypeError&&(e.message=`Stimulus Value "${this.context.identifier}.${s.name}" - ${e.message}`),e}}}get valueDescriptors(){const{valueDescriptorMap:e}=this;return Object.keys(e).map((t=>e[t]))}get valueDescriptorNameMap(){const e={};return Object.keys(this.valueDescriptorMap).forEach((t=>{const i=this.valueDescriptorMap[t];e[i.name]=i})),e}hasValue(e){const t=`has${R(this.valueDescriptorNameMap[e].name)}`;return this.receiver[t]}}class te{constructor(e,t){this.context=e,this.delegate=t,this.targetsByName=new z}start(){this.tokenListObserver||(this.tokenListObserver=new Y(this.element,this.attributeName,this),this.tokenListObserver.start())}stop(){this.tokenListObserver&&(this.disconnectAllTargets(),this.tokenListObserver.stop(),delete this.tokenListObserver)}tokenMatched({element:e,content:t}){this.scope.containsElement(e)&&this.connectTarget(e,t)}tokenUnmatched({element:e,content:t}){this.disconnectTarget(e,t)}connectTarget(e,t){var i;this.targetsByName.has(t,e)||(this.targetsByName.add(t,e),null===(i=this.tokenListObserver)||void 0===i||i.pause((()=>this.delegate.targetConnected(e,t))))}disconnectTarget(e,t){var i;this.targetsByName.has(t,e)&&(this.targetsByName.delete(t,e),null===(i=this.tokenListObserver)||void 0===i||i.pause((()=>this.delegate.targetDisconnected(e,t))))}disconnectAllTargets(){for(const e of this.targetsByName.keys)for(const t of this.targetsByName.getValuesForKey(e))this.disconnectTarget(t,e)}get attributeName(){return`data-${this.context.identifier}-target`}get element(){return this.context.element}get scope(){return this.context.scope}}function ie(e,t){const i=se(e);return Array.from(i.reduce(((e,i)=>(function(e,t){const i=e[t];return Array.isArray(i)?i:[]}(i,t).forEach((t=>e.add(t))),e)),new Set))}function se(e){const t=[];for(;e;)t.push(e),e=Object.getPrototypeOf(e);return t.reverse()}class ne{constructor(e,t){this.context=e,this.delegate=t,this.outletsByName=new z,this.outletElementsByName=new z,this.selectorObserverMap=new Map}start(){0===this.selectorObserverMap.size&&(this.outletDefinitions.forEach((e=>{const t=this.selector(e),i={outletName:e};t&&this.selectorObserverMap.set(e,new J(document.body,t,this,i))})),this.selectorObserverMap.forEach((e=>e.start()))),this.dependentContexts.forEach((e=>e.refresh()))}stop(){this.selectorObserverMap.size>0&&(this.disconnectAllOutlets(),this.selectorObserverMap.forEach((e=>e.stop())),this.selectorObserverMap.clear())}refresh(){this.selectorObserverMap.forEach((e=>e.refresh()))}selectorMatched(e,t,{outletName:i}){const s=this.getOutlet(e,i);s&&this.connectOutlet(s,e,i)}selectorUnmatched(e,t,{outletName:i}){const s=this.getOutletFromMap(e,i);s&&this.disconnectOutlet(s,e,i)}selectorMatchElement(e,{outletName:t}){return this.hasOutlet(e,t)&&e.matches(`[${this.context.application.schema.controllerAttribute}~=${t}]`)}connectOutlet(e,t,i){var s;this.outletElementsByName.has(i,t)||(this.outletsByName.add(i,e),this.outletElementsByName.add(i,t),null===(s=this.selectorObserverMap.get(i))||void 0===s||s.pause((()=>this.delegate.outletConnected(e,t,i))))}disconnectOutlet(e,t,i){var s;this.outletElementsByName.has(i,t)&&(this.outletsByName.delete(i,e),this.outletElementsByName.delete(i,t),null===(s=this.selectorObserverMap.get(i))||void 0===s||s.pause((()=>this.delegate.outletDisconnected(e,t,i))))}disconnectAllOutlets(){for(const e of this.outletElementsByName.keys)for(const t of this.outletElementsByName.getValuesForKey(e))for(const i of this.outletsByName.getValuesForKey(e))this.disconnectOutlet(i,t,e)}selector(e){return this.scope.outlets.getSelectorForOutletName(e)}get outletDependencies(){const e=new z;return this.router.modules.forEach((t=>{ie(t.definition.controllerConstructor,"outlets").forEach((i=>e.add(i,t.identifier)))})),e}get outletDefinitions(){return this.outletDependencies.getKeysForValue(this.identifier)}get dependentControllerIdentifiers(){return this.outletDependencies.getValuesForKey(this.identifier)}get dependentContexts(){const e=this.dependentControllerIdentifiers;return this.router.contexts.filter((t=>e.includes(t.identifier)))}hasOutlet(e,t){return!!this.getOutlet(e,t)||!!this.getOutletFromMap(e,t)}getOutlet(e,t){return this.application.getControllerForElementAndIdentifier(e,t)}getOutletFromMap(e,t){return this.outletsByName.getValuesForKey(t).find((t=>t.element===e))}get scope(){return this.context.scope}get identifier(){return this.context.identifier}get application(){return this.context.application}get router(){return this.application.router}}class re{constructor(e,t){this.logDebugActivity=(e,t={})=>{const{identifier:i,controller:s,element:n}=this;t=Object.assign({identifier:i,controller:s,element:n},t),this.application.logDebugActivity(this.identifier,e,t)},this.module=e,this.scope=t,this.controller=new e.controllerConstructor(this),this.bindingObserver=new Q(this,this.dispatcher),this.valueObserver=new ee(this,this.controller),this.targetObserver=new te(this,this),this.outletObserver=new ne(this,this);try{this.controller.initialize(),this.logDebugActivity("initialize")}catch(e){this.handleError(e,"initializing controller")}}connect(){this.bindingObserver.start(),this.valueObserver.start(),this.targetObserver.start(),this.outletObserver.start();try{this.controller.connect(),this.logDebugActivity("connect")}catch(e){this.handleError(e,"connecting controller")}}refresh(){this.outletObserver.refresh()}disconnect(){try{this.controller.disconnect(),this.logDebugActivity("disconnect")}catch(e){this.handleError(e,"disconnecting controller")}this.outletObserver.stop(),this.targetObserver.stop(),this.valueObserver.stop(),this.bindingObserver.stop()}get application(){return this.module.application}get identifier(){return this.module.identifier}get schema(){return this.application.schema}get dispatcher(){return this.application.dispatcher}get element(){return this.scope.element}get parentElement(){return this.element.parentElement}handleError(e,t,i={}){const{identifier:s,controller:n,element:r}=this;i=Object.assign({identifier:s,controller:n,element:r},i),this.application.handleError(e,`Error ${t}`,i)}targetConnected(e,t){this.invokeControllerMethod(`${t}TargetConnected`,e)}targetDisconnected(e,t){this.invokeControllerMethod(`${t}TargetDisconnected`,e)}outletConnected(e,t,i){this.invokeControllerMethod(`${D(i)}OutletConnected`,e,t)}outletDisconnected(e,t,i){this.invokeControllerMethod(`${D(i)}OutletDisconnected`,e,t)}invokeControllerMethod(e,...t){const i=this.controller;"function"==typeof i[e]&&i[e](...t)}}const ae="function"==typeof Object.getOwnPropertySymbols?e=>[...Object.getOwnPropertyNames(e),...Object.getOwnPropertySymbols(e)]:Object.getOwnPropertyNames,oe=(()=>{function e(e){function t(){return Reflect.construct(e,arguments,new.target)}return t.prototype=Object.create(e.prototype,{constructor:{value:t}}),Reflect.setPrototypeOf(t,e),t}try{return function(){const t=e((function(){this.a.call(this)}));t.prototype.a=function(){},new t}(),e}catch(e){return e=>class extends e{}}})();class de{constructor(e,t){this.application=e,this.definition=function(e){return{identifier:e.identifier,controllerConstructor:(t=e.controllerConstructor,function(e,t){const i=oe(e),s=function(e,t){return ae(t).reduce(((i,s)=>{const n=function(e,t,i){const s=Object.getOwnPropertyDescriptor(e,i);if(!s||!("value"in s)){const e=Object.getOwnPropertyDescriptor(t,i).value;return s&&(e.get=s.get||e.get,e.set=s.set||e.set),e}}(e,t,s);return n&&Object.assign(i,{[s]:n}),i}),{})}(e.prototype,t);return Object.defineProperties(i.prototype,s),i}(t,function(e){return ie(e,"blessings").reduce(((t,i)=>{const s=i(e);for(const e in s){const i=t[e]||{};t[e]=Object.assign(i,s[e])}return t}),{})}(t)))};var t}(t),this.contextsByScope=new WeakMap,this.connectedContexts=new Set}get identifier(){return this.definition.identifier}get controllerConstructor(){return this.definition.controllerConstructor}get contexts(){return Array.from(this.connectedContexts)}connectContextForScope(e){const t=this.fetchContextForScope(e);this.connectedContexts.add(t),t.connect()}disconnectContextForScope(e){const t=this.contextsByScope.get(e);t&&(this.connectedContexts.delete(t),t.disconnect())}fetchContextForScope(e){let t=this.contextsByScope.get(e);return t||(t=new re(this,e),this.contextsByScope.set(e,t)),t}}class ce{constructor(e){this.scope=e}has(e){return this.data.has(this.getDataKey(e))}get(e){return this.getAll(e)[0]}getAll(e){return(this.data.get(this.getDataKey(e))||"").match(/[^\s]+/g)||[]}getAttributeName(e){return this.data.getAttributeNameForKey(this.getDataKey(e))}getDataKey(e){return`${e}-class`}get data(){return this.scope.data}}class le{constructor(e){this.scope=e}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get(e){const t=this.getAttributeNameForKey(e);return this.element.getAttribute(t)}set(e,t){const i=this.getAttributeNameForKey(e);return this.element.setAttribute(i,t),this.get(e)}has(e){const t=this.getAttributeNameForKey(e);return this.element.hasAttribute(t)}delete(e){if(this.has(e)){const t=this.getAttributeNameForKey(e);return this.element.removeAttribute(t),!0}return!1}getAttributeNameForKey(e){return`data-${this.identifier}-${B(e)}`}}class he{constructor(e){this.warnedKeysByObject=new WeakMap,this.logger=e}warn(e,t,i){let s=this.warnedKeysByObject.get(e);s||(s=new Set,this.warnedKeysByObject.set(e,s)),s.has(t)||(s.add(t),this.logger.warn(i,e))}}function ue(e,t){return`[${e}~="${t}"]`}class pe{constructor(e){this.scope=e}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get schema(){return this.scope.schema}has(e){return null!=this.find(e)}find(...e){return e.reduce(((e,t)=>e||this.findTarget(t)||this.findLegacyTarget(t)),void 0)}findAll(...e){return e.reduce(((e,t)=>[...e,...this.findAllTargets(t),...this.findAllLegacyTargets(t)]),[])}findTarget(e){const t=this.getSelectorForTargetName(e);return this.scope.findElement(t)}findAllTargets(e){const t=this.getSelectorForTargetName(e);return this.scope.findAllElements(t)}getSelectorForTargetName(e){return ue(this.schema.targetAttributeForScope(this.identifier),e)}findLegacyTarget(e){const t=this.getLegacySelectorForTargetName(e);return this.deprecate(this.scope.findElement(t),e)}findAllLegacyTargets(e){const t=this.getLegacySelectorForTargetName(e);return this.scope.findAllElements(t).map((t=>this.deprecate(t,e)))}getLegacySelectorForTargetName(e){const t=`${this.identifier}.${e}`;return ue(this.schema.targetAttribute,t)}deprecate(e,t){if(e){const{identifier:i}=this,s=this.schema.targetAttribute,n=this.schema.targetAttributeForScope(i);this.guide.warn(e,`target:${t}`,`Please replace ${s}="${i}.${t}" with ${n}="${t}". The ${s} attribute is deprecated and will be removed in a future version of Stimulus.`)}return e}get guide(){return this.scope.guide}}class me{constructor(e,t){this.scope=e,this.controllerElement=t}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get schema(){return this.scope.schema}has(e){return null!=this.find(e)}find(...e){return e.reduce(((e,t)=>e||this.findOutlet(t)),void 0)}findAll(...e){return e.reduce(((e,t)=>[...e,...this.findAllOutlets(t)]),[])}getSelectorForOutletName(e){const t=this.schema.outletAttributeForScope(this.identifier,e);return this.controllerElement.getAttribute(t)}findOutlet(e){const t=this.getSelectorForOutletName(e);if(t)return this.findElement(t,e)}findAllOutlets(e){const t=this.getSelectorForOutletName(e);return t?this.findAllElements(t,e):[]}findElement(e,t){return this.scope.queryElements(e).filter((i=>this.matchesElement(i,e,t)))[0]}findAllElements(e,t){return this.scope.queryElements(e).filter((i=>this.matchesElement(i,e,t)))}matchesElement(e,t,i){const s=e.getAttribute(this.scope.schema.controllerAttribute)||"";return e.matches(t)&&s.split(" ").includes(i)}}class ge{constructor(e,t,i,s){this.targets=new pe(this),this.classes=new ce(this),this.data=new le(this),this.containsElement=e=>e.closest(this.controllerSelector)===this.element,this.schema=e,this.element=t,this.identifier=i,this.guide=new he(s),this.outlets=new me(this.documentScope,t)}findElement(e){return this.element.matches(e)?this.element:this.queryElements(e).find(this.containsElement)}findAllElements(e){return[...this.element.matches(e)?[this.element]:[],...this.queryElements(e).filter(this.containsElement)]}queryElements(e){return Array.from(this.element.querySelectorAll(e))}get controllerSelector(){return ue(this.schema.controllerAttribute,this.identifier)}get isDocumentScope(){return this.element===document.documentElement}get documentScope(){return this.isDocumentScope?this:new ge(this.schema,document.documentElement,this.identifier,this.guide.logger)}}class fe{constructor(e,t,i){this.element=e,this.schema=t,this.delegate=i,this.valueListObserver=new Z(this.element,this.controllerAttribute,this),this.scopesByIdentifierByElement=new WeakMap,this.scopeReferenceCounts=new WeakMap}start(){this.valueListObserver.start()}stop(){this.valueListObserver.stop()}get controllerAttribute(){return this.schema.controllerAttribute}parseValueForToken(e){const{element:t,content:i}=e,s=this.fetchScopesByIdentifierForElement(t);let n=s.get(i);return n||(n=this.delegate.createScopeForElementAndIdentifier(t,i),s.set(i,n)),n}elementMatchedValue(e,t){const i=(this.scopeReferenceCounts.get(t)||0)+1;this.scopeReferenceCounts.set(t,i),1==i&&this.delegate.scopeConnected(t)}elementUnmatchedValue(e,t){const i=this.scopeReferenceCounts.get(t);i&&(this.scopeReferenceCounts.set(t,i-1),1==i&&this.delegate.scopeDisconnected(t))}fetchScopesByIdentifierForElement(e){let t=this.scopesByIdentifierByElement.get(e);return t||(t=new Map,this.scopesByIdentifierByElement.set(e,t)),t}}class be{constructor(e){this.application=e,this.scopeObserver=new fe(this.element,this.schema,this),this.scopesByIdentifier=new z,this.modulesByIdentifier=new Map}get element(){return this.application.element}get schema(){return this.application.schema}get logger(){return this.application.logger}get controllerAttribute(){return this.schema.controllerAttribute}get modules(){return Array.from(this.modulesByIdentifier.values())}get contexts(){return this.modules.reduce(((e,t)=>e.concat(t.contexts)),[])}start(){this.scopeObserver.start()}stop(){this.scopeObserver.stop()}loadDefinition(e){this.unloadIdentifier(e.identifier);const t=new de(this.application,e);this.connectModule(t);const i=e.controllerConstructor.afterLoad;i&&i(e.identifier,this.application)}unloadIdentifier(e){const t=this.modulesByIdentifier.get(e);t&&this.disconnectModule(t)}getContextForElementAndIdentifier(e,t){const i=this.modulesByIdentifier.get(t);if(i)return i.contexts.find((t=>t.element==e))}handleError(e,t,i){this.application.handleError(e,t,i)}createScopeForElementAndIdentifier(e,t){return new ge(this.schema,e,t,this.logger)}scopeConnected(e){this.scopesByIdentifier.add(e.identifier,e);const t=this.modulesByIdentifier.get(e.identifier);t&&t.connectContextForScope(e)}scopeDisconnected(e){this.scopesByIdentifier.delete(e.identifier,e);const t=this.modulesByIdentifier.get(e.identifier);t&&t.disconnectContextForScope(e)}connectModule(e){this.modulesByIdentifier.set(e.identifier,e),this.scopesByIdentifier.getValuesForKey(e.identifier).forEach((t=>e.connectContextForScope(t)))}disconnectModule(e){this.modulesByIdentifier.delete(e.identifier),this.scopesByIdentifier.getValuesForKey(e.identifier).forEach((t=>e.disconnectContextForScope(t)))}}const ve={controllerAttribute:"data-controller",actionAttribute:"data-action",targetAttribute:"data-target",targetAttributeForScope:e=>`data-${e}-target`,outletAttributeForScope:(e,t)=>`data-${e}-${t}-outlet`,keyMappings:Object.assign(Object.assign({enter:"Enter",tab:"Tab",esc:"Escape",space:" ",up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight",home:"Home",end:"End"},we("abcdefghijklmnopqrstuvwxyz".split("").map((e=>[e,e])))),we("0123456789".split("").map((e=>[e,e]))))};function we(e){return e.reduce(((e,[t,i])=>Object.assign(Object.assign({},e),{[t]:i})),{})}function ye([e,t],i){return function(e){const t=`${B(e.token)}-value`,i=function(e){const t=function(e){const t=Ee(e.typeObject.type);if(!t)return;const i=ke(e.typeObject.default);if(t!==i){throw new Error(`The specified default value for the Stimulus Value "${e.controller?`${e.controller}.${e.token}`:e.token}" must match the defined type "${t}". The provided default value of "${e.typeObject.default}" is of type "${i}".`)}return t}({controller:e.controller,token:e.token,typeObject:e.typeDefinition}),i=ke(e.typeDefinition),s=Ee(e.typeDefinition),n=t||i||s;if(n)return n;throw new Error(`Unknown value type "${e.controller?`${e.controller}.${e.typeDefinition}`:e.token}" for "${e.token}" value`)}(e);return{type:i,key:t,name:M(t),get defaultValue(){return function(e){const t=Ee(e);if(t)return Ce[t];const i=e.default;return void 0!==i?i:e}(e.typeDefinition)},get hasCustomDefaultValue(){return void 0!==ke(e.typeDefinition)},reader:Ae[i],writer:Oe[i]||Oe.default}}({controller:i,token:e,typeDefinition:t})}function Ee(e){switch(e){case Array:return"array";case Boolean:return"boolean";case Number:return"number";case Object:return"object";case String:return"string"}}function ke(e){switch(typeof e){case"boolean":return"boolean";case"number":return"number";case"string":return"string"}return Array.isArray(e)?"array":"[object Object]"===Object.prototype.toString.call(e)?"object":void 0}const Ce={get array(){return[]},boolean:!1,number:0,get object(){return{}},string:""},Ae={array(e){const t=JSON.parse(e);if(!Array.isArray(t))throw new TypeError(`expected value of type "array" but instead got value "${e}" of type "${ke(t)}"`);return t},boolean:e=>!("0"==e||"false"==String(e).toLowerCase()),number:e=>Number(e),object(e){const t=JSON.parse(e);if(null===t||"object"!=typeof t||Array.isArray(t))throw new TypeError(`expected value of type "object" but instead got value "${e}" of type "${ke(t)}"`);return t},string:e=>e},Oe={default:function(e){return`${e}`},array:xe,object:xe};function xe(e){return JSON.stringify(e)}class Fe{constructor(e){this.context=e}static get shouldLoad(){return!0}static afterLoad(e,t){}get application(){return this.context.application}get scope(){return this.context.scope}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get targets(){return this.scope.targets}get outlets(){return this.scope.outlets}get classes(){return this.scope.classes}get data(){return this.scope.data}initialize(){}connect(){}disconnect(){}dispatch(e,{target:t=this.element,detail:i={},prefix:s=this.identifier,bubbles:n=!0,cancelable:r=!0}={}){const a=new CustomEvent(s?`${s}:${e}`:e,{detail:i,bubbles:n,cancelable:r});return t.dispatchEvent(a),a}}Fe.blessings=[function(e){return ie(e,"classes").reduce(((e,t)=>{return Object.assign(e,{[`${i=t}Class`]:{get(){const{classes:e}=this;if(e.has(i))return e.get(i);{const t=e.getAttributeName(i);throw new Error(`Missing attribute "${t}"`)}}},[`${i}Classes`]:{get(){return this.classes.getAll(i)}},[`has${R(i)}Class`]:{get(){return this.classes.has(i)}}});var i}),{})},function(e){return ie(e,"targets").reduce(((e,t)=>{return Object.assign(e,{[`${i=t}Target`]:{get(){const e=this.targets.find(i);if(e)return e;throw new Error(`Missing target element "${i}" for "${this.identifier}" controller`)}},[`${i}Targets`]:{get(){return this.targets.findAll(i)}},[`has${R(i)}Target`]:{get(){return this.targets.has(i)}}});var i}),{})},function(e){const t=function(e,t){return se(e).reduce(((e,i)=>(e.push(...function(e,t){const i=e[t];return i?Object.keys(i).map((e=>[e,i[e]])):[]}(i,t)),e)),[])}(e,"values"),i={valueDescriptorMap:{get(){return t.reduce(((e,t)=>{const i=ye(t,this.identifier),s=this.data.getAttributeNameForKey(i.key);return Object.assign(e,{[s]:i})}),{})}}};return t.reduce(((e,t)=>Object.assign(e,function(e,t){const i=ye(e,void 0),{key:s,name:n,reader:r,writer:a}=i;return{[n]:{get(){const e=this.data.get(s);return null!==e?r(e):i.defaultValue},set(e){void 0===e?this.data.delete(s):this.data.set(s,a(e))}},[`has${R(n)}`]:{get(){return this.data.has(s)||i.hasCustomDefaultValue}}}}(t))),i)},function(e){return ie(e,"outlets").reduce(((e,t)=>Object.assign(e,function(e){const t=D(e);return{[`${t}Outlet`]:{get(){const t=this.outlets.find(e);if(t){const i=this.application.getControllerForElementAndIdentifier(t,e);if(i)return i;throw new Error(`Missing "data-controller=${e}" attribute on outlet element for "${this.identifier}" controller`)}throw new Error(`Missing outlet element "${e}" for "${this.identifier}" controller`)}},[`${t}Outlets`]:{get(){const t=this.outlets.findAll(e);return t.length>0?t.map((t=>{const i=this.application.getControllerForElementAndIdentifier(t,e);if(i)return i;console.warn(`The provided outlet element is missing the outlet controller "${e}" for "${this.identifier}"`,t)})).filter((e=>e)):[]}},[`${t}OutletElement`]:{get(){const t=this.outlets.find(e);if(t)return t;throw new Error(`Missing outlet element "${e}" for "${this.identifier}" controller`)}},[`${t}OutletElements`]:{get(){return this.outlets.findAll(e)}},[`has${R(t)}Outlet`]:{get(){return this.outlets.has(e)}}}}(t))),{})}],Fe.targets=[],Fe.outlets=[],Fe.values={};const Ie=e=>{const t=document.getElementById(`widget-${e.identifier}-template`);t&&(e.element.innerHTML=t.innerHTML)},We=(()=>{const e=()=>window.Wrapped.giftOptions.filter((e=>e.available));return{anyAvailable:()=>e().length>0,availableOptions:t=>(t=>e().filter((e=>!o.isFilteredGiftOption(t,e.id))))(t),firstAvailable:t=>0===t?e()[0]:e().find((e=>!o.isFilteredGiftOption(t,e.id)))}})(),Le=(t,i)=>{window.Wrapped.settings.block&&((t,i)=>{(0,e.debug)("storefront-beacon",`pinging widget: ${t.widget}`);const s=i.parentElement.dataset,n=i.parentElement.classList;let r;const a=t.widget===s.position,o=n.contains("shopify-block")||n.contains("shopify-app-block");if(a&&(r="data-position"),o&&(r="shopify-block"),!a&&!o&&(r="query-selector"),!window.sessionStorage.getItem("wrapped-beacon")||window.Shopify?.designMode){try{const e={method:"POST",headers:{"Content-Type":"application/json"},keepalive:!0,body:JSON.stringify({editor:window.Shopify?.designMode,version:window.Wrapped.version||"wrapped-0",widget:{id:t.id,positioned_by:r,last_reported_selector:i.dataset?.selector},theme:{id:window.Wrapped.theme.id,settings:window.Wrapped.settings.block,shopify:{...window.Shopify?.theme}},shop:window.Shopify?.shop})};fetch("https://beacons.wrapped.alacartapps.co/production/storefront",e)}catch(e){console.error(e)}window.sessionStorage.setItem("wrapped-beacon","true")}})(t,i)};var _e=class extends Fe{static values={touchedAt:{type:Number,default:0},index:Number,key:String,selectedOption:Number,accountLimited:Boolean};initialize(){this.cartWidgetsEnabled?window.Wrapped.settings.customer_filtered||((0,e.debug)(this.identifier,`init - ${this.indexValue}`),this.settings=F(this.identifier),this.accountLimitedValue=this.isAccountLimited(),Le(this.settings,this.element),this.setupController(),this.element.addEventListener("giftOption:changed",this.giftOptionChanged.bind(this))):n.m.removeItems(0)}connect(){(0,e.debug)(this.identifier,`conn - ${this.indexValue}`)}disconnect(){(0,e.debug)(this.identifier,`exit - ${this.indexValue}`),document.dispatchEvent(new CustomEvent("wrapped:cart:register",{detail:{identifier:this.identifier}})),document.dispatchEvent(new CustomEvent("wrapped:widget:setup"))}touchedAtValueChanged(t,i){void 0!==t&&0!==t&&((0,e.debug)(this.identifier,`touched at: ${t}`),this.setupController())}isAccountLimited(){const e=new Date(window.Wrapped.settings.account_limited_on),t=new Date;return window.Wrapped.settings.account_limited&&e<t}giftOptionChanged(e){this.selectedOptionValue=e.detail.giftOptionId,e.detail.checked&&0!==Number(this.selectedOptionValue)?window.Wrapped.cart?.items.forEach((e=>{if(a.isGift(e.variant_id))return;if(o.isFilteredProduct(e.product_id))return;if(o.isFilteredGiftOption(e.product_id,this.firstAvailableGiftOptionId()))return;const t=e.properties?._WrappedId||e.variant_id;"cart"===n.m.getItem(t,"claimed")&&(n.m.setItem(t,"checked",!0),n.m.setItem(t,"selected",this.selectedOptionValue))})):n.m.removeAllItems(),document.dispatchEvent(new CustomEvent("wrapped:cart:items",{detail:{identifier:this.identifier}})),document.dispatchEvent(new CustomEvent("wrapped:variant:changed",{detail:{identifier:this.identifier,key:this.keyValue,selectedOption:this.selectedOptionValue}})),this.refreshComponents(!0)}firstAvailableGiftOptionId(){return We.firstAvailable(0)?.id}setupController(){this.settings&&(this.keyValue="0",this.element.setAttribute("is-checked",n.m.getItem(this.keyValue,"checked")),this.element.setAttribute("is-gift",a.isGift(this.keyValue)),this.element.setAttribute("widget-type","cart"),this.element.setAttribute("storage-key",this.keyValue),this.element.setAttribute("selected-option-id",n.m.getItem(this.keyValue,"selected")),this.element.setAttribute("gift-option-id",this.keyValue),this.element.setAttribute("gift-option-filters",window.Wrapped.settings.filters[this.keyValue]),this.element.setAttribute("hidden-checkbox",!1===this.settings.checkbox),this.element.setAttribute("selector-type",this.settings.variantSelector),this.element.setAttribute("message-enabled",this.settings.message),this.element.setAttribute("message-max-length",this.settings.messageMaxLength),this.element.setAttribute("sender-receiver-enabled",this.settings.senderReceiver),this.element.setAttribute("sender-receiver-fields",this.settings.senderReceiverFields),this.setupTemplate(),this.setupFeatureControllers())}async setupTemplate(){if(Ie(this),this.element.style.display="",await b())return(0,e.debug)(this.identifier,"controller hidden due to all products being filtered"),void(this.element.style.display="none");window.Wrapped.cart?.items&&0!==window.Wrapped.cart.items.length||((0,e.debug)(this.identifier,"controller hidden due to empty cart"),this.element.style.display="none"),this.settings?.poweredBy||this.poweredByFeature?.remove()}setupFeatureControllers(){this.selectedOptionValue=n.m.getItem(this.keyValue,"selected"),this.refreshComponents()}refreshComponents(e=!1){this.element.setAttribute("is-checked",n.m.getItem(this.keyValue,"checked")),this.element.setAttribute("skip-render-update",this.skipComponentRenderUpdate(e)),this.element.setAttribute("selected-option-id",n.m.getItem(this.keyValue,"selected"));const t=(new Date).getTime();this.featureComponents.forEach((e=>{e?.setAttribute("refreshed-at",t)}))}skipComponentRenderUpdate(e){if(e)return!!this.settings.actionDelayRender||!(!this.settings.actionReload||this.settings.actionEvent||this.settings.actionFunction)||void 0}get cartWidgetsEnabled(){return window.Wrapped.enabledWidgets["wrapped-cart"]||window.Wrapped.enabledWidgets["wrapped-cart-drawer"]}get featureComponents(){return[this.checkboxFeature,this.variantsFeature,this.messageFeature,this.senderReceiverFeature,this.poweredByFeature]}get checkboxFeature(){return this.element.querySelector("feature-checkbox")}get variantsFeature(){return this.element.querySelector("feature-variants")}get messageFeature(){return this.element.querySelector("feature-message")}get senderReceiverFeature(){return this.element.querySelector("feature-sender-recipient")}get poweredByFeature(){return this.element.querySelector("feature-powered-by")}},Te=class extends Fe{static values={touchedAt:{type:Number,default:0},index:Number,key:String,selectedOption:Number,accountLimited:Boolean};initialize(){this.cartWidgetsEnabled?window.Wrapped.settings.customer_filtered||((0,e.debug)(this.identifier,`init - ${this.indexValue}`),this.settings=F(this.identifier),this.accountLimitedValue=this.isAccountLimited(),Le(this.settings,this.element),this.setupController(),this.element.addEventListener("giftOption:changed",this.giftOptionChanged.bind(this))):n.m.removeItems(0)}connect(){(0,e.debug)(this.identifier,`conn - ${this.indexValue}`)}disconnect(){(0,e.debug)(this.identifier,`exit - ${this.indexValue}`),document.dispatchEvent(new CustomEvent("wrapped:cart:register",{detail:{identifier:this.identifier}})),document.dispatchEvent(new CustomEvent("wrapped:widget:setup"))}touchedAtValueChanged(t,i){void 0!==t&&0!==t&&((0,e.debug)(this.identifier,`touched at: ${t}`),this.setupController())}isAccountLimited(){const e=new Date(window.Wrapped.settings.account_limited_on),t=new Date;return window.Wrapped.settings.account_limited&&e<t}giftOptionChanged(e){this.selectedOptionValue=e.detail.giftOptionId,e.detail.checked&&0!==Number(this.selectedOptionValue)?window.Wrapped.cart?.items.forEach((e=>{if(a.isGift(e.variant_id))return;if(o.isFilteredProduct(e.product_id))return;if(o.isFilteredGiftOption(e.product_id,this.firstAvailableGiftOptionId()))return;const t=e.properties?._WrappedId||e.variant_id;"cart"===n.m.getItem(t,"claimed")&&(n.m.setItem(t,"checked",!0),n.m.setItem(t,"selected",this.selectedOptionValue))})):n.m.removeAllItems(),document.dispatchEvent(new CustomEvent("wrapped:cart:items",{detail:{identifier:this.identifier}})),document.dispatchEvent(new CustomEvent("wrapped:variant:changed",{detail:{identifier:this.identifier,key:this.keyValue,selectedOption:this.selectedOptionValue}})),this.refreshComponents(!0)}firstAvailableGiftOptionId(){return We.firstAvailable(0)?.id}setupController(){this.settings&&(this.keyValue="0",this.element.setAttribute("is-checked",n.m.getItem(this.keyValue,"checked")),this.element.setAttribute("is-gift",a.isGift(this.keyValue)),this.element.setAttribute("widget-type","cart"),this.element.setAttribute("storage-key",this.keyValue),this.element.setAttribute("selected-option-id",n.m.getItem(this.keyValue,"selected")),this.element.setAttribute("gift-option-id",this.keyValue),this.element.setAttribute("gift-option-filters",window.Wrapped.settings.filters[this.keyValue]),this.element.setAttribute("hidden-checkbox",!1===this.settings.checkbox),this.element.setAttribute("selector-type",this.settings.variantSelector),this.element.setAttribute("message-enabled",this.settings.message),this.element.setAttribute("message-max-length",this.settings.messageMaxLength),this.element.setAttribute("sender-receiver-enabled",this.settings.senderReceiver),this.element.setAttribute("sender-receiver-fields",this.settings.senderReceiverFields),this.setupTemplate(),this.setupFeatureControllers())}async setupTemplate(){if(Ie(this),this.element.style.display="",await b())return(0,e.debug)(this.identifier,"controller hidden due to all products being filtered"),void(this.element.style.display="none");window.Wrapped.cart?.items&&0!==window.Wrapped.cart.items.length||((0,e.debug)(this.identifier,"controller hidden due to empty cart"),this.element.style.display="none"),this.settings?.poweredBy||this.poweredByFeature?.remove()}setupFeatureControllers(){this.selectedOptionValue=n.m.getItem(this.keyValue,"selected"),this.refreshComponents()}refreshComponents(e=!1){this.element.setAttribute("is-checked",n.m.getItem(this.keyValue,"checked")),this.element.setAttribute("skip-render-update",this.skipComponentRenderUpdate(e)),this.element.setAttribute("selected-option-id",n.m.getItem(this.keyValue,"selected"));const t=(new Date).getTime();this.featureComponents.forEach((e=>{e?.setAttribute("refreshed-at",t)}))}skipComponentRenderUpdate(e){if(e)return!!this.settings.actionDelayRender||!(!this.settings.actionReload||this.settings.actionEvent||this.settings.actionFunction)||void 0}get cartWidgetsEnabled(){return window.Wrapped.enabledWidgets["wrapped-cart"]||window.Wrapped.enabledWidgets["wrapped-cart-drawer"]}get featureComponents(){return[this.checkboxFeature,this.variantsFeature,this.messageFeature,this.senderReceiverFeature,this.poweredByFeature]}get checkboxFeature(){return this.element.querySelector("feature-checkbox")}get variantsFeature(){return this.element.querySelector("feature-variants")}get messageFeature(){return this.element.querySelector("feature-message")}get senderReceiverFeature(){return this.element.querySelector("feature-sender-recipient")}get poweredByFeature(){return this.element.querySelector("feature-powered-by")}};const $e=(()=>{const t="cart-item-finder";let i=!1;const s=async r=>{(0,e.debug)(t,`*fetching ${r.identifier}-${r.indexValue}`),n(r)&&((0,e.debug)(t,`missed ${r.identifier}-${r.indexValue}`),i||(s=>{(0,e.debug)(t,`dispatching register ${s.identifier}-${s.indexValue}`),i=!0,document.dispatchEvent(new CustomEvent("wrapped:cart:register",{detail:{identifier:s.identifier}}))})(r),await(50,new Promise((e=>setTimeout(e,50)))),await s(r)),i=!1},n=e=>!r(e)||0===Object.keys(r(e)).length,r=i=>{(0,e.debug)(t,"*lookup",{controller:i.identifier,index:i.indexValue,items:window.Wrapped.cart?.items,item:window.Wrapped.cart?.items[i.indexValue]});const s=window.Wrapped.cart?.items;if(!s||0===s.length)throw new Error("EmptyCart");if(void 0===s[i.indexValue])throw new Error("IndexBoundary");return s[i.indexValue]};return{fetch:async(i,n=0)=>{(0,e.debug)(t,`starting ${i.identifier}-${i.indexValue}`);try{return await s(i),r(i)}catch(s){return"IndexBoundary"===s.message?((0,e.error)(t,"index boundary",{controller:i.identifier,index:i.indexValue,items:window.Wrapped.cart?.items}),void i.element.remove()):n<10?((0,e.debug)(t,`retrying ${i.identifier}-${i.indexValue}, attempt: ${n+1}`),$e.fetch(i,n+1)):void(0,e.error)(t,`retries exhausted ${i.identifier}-${i.indexValue}, attempt: ${n+1}`,{controller:i,retryCount:n})}}}})();var Se=class extends Fe{static values={touchedAt:{type:Number,default:0},index:Number,key:String,selectedOption:Number,accountLimited:Boolean};initialize(){window.Wrapped.enabledWidgets[this.identifier]&&(window.Wrapped.settings.customer_filtered||((0,e.debug)(this.identifier,`init - ${this.indexValue}`),this.settings=F(this.identifier),this.accountLimitedValue=this.isAccountLimited(),Le(this.settings,this.element),this.element.addEventListener("giftOption:changed",this.giftOptionChanged.bind(this))))}connect(){(0,e.debug)(this.identifier,`conn - ${this.indexValue}`)}disconnect(){(0,e.debug)(this.identifier,`exit - ${this.indexValue}`),document.dispatchEvent(new CustomEvent("wrapped:cart:register",{detail:{identifier:this.identifier}})),document.dispatchEvent(new CustomEvent("wrapped:widget:setup"))}indexValueChanged(e,t){this.setupController()}touchedAtValueChanged(t,i){void 0!==t&&0!==t&&((0,e.debug)(this.identifier,`touched at: ${t}`),this.setupController())}isAccountLimited(){const e=new Date(window.Wrapped.settings.account_limited_on),t=new Date;return window.Wrapped.settings.account_limited&&e<t}giftOptionChanged(e){this.selectedOptionValue=e.detail.giftOptionId,e.detail.checked&&0!==Number(this.selectedOptionValue)||(n.m.removeItems(0),n.m.removeItems(this.keyValue)),document.dispatchEvent(new CustomEvent("wrapped:cart:items",{detail:{identifier:this.identifier}})),document.dispatchEvent(new CustomEvent("wrapped:variant:changed",{detail:{identifier:this.identifier,key:this.keyValue,selectedOption:this.selectedOptionValue}})),this.refreshComponents(!0)}async setupController(){if(!this.settings)return;const e=await $e.fetch(this);void 0!==e&&(this.keyValue=this.storageKey(e),this.element.setAttribute("is-checked",n.m.getItem(this.keyValue,"checked")),this.element.setAttribute("is-gift",a.isGift(e.variant_id)),this.element.setAttribute("widget-type","item"),this.element.setAttribute("storage-key",this.keyValue),this.element.setAttribute("selected-option-id",n.m.getItem(this.keyValue,"selected")),this.element.setAttribute("gift-option-id",e.variant_id),this.element.setAttribute("gift-option-filters",window.Wrapped.settings.filters[e.product_id]),this.element.setAttribute("hidden-checkbox",!1===this.settings.checkbox),this.element.setAttribute("selector-type",this.settings.variantSelector),this.element.setAttribute("message-enabled",this.settings.message),this.element.setAttribute("message-max-length",this.settings.messageMaxLength),this.element.setAttribute("sender-receiver-enabled",this.settings.senderReceiver),this.element.setAttribute("sender-receiver-fields",this.settings.senderReceiverFields),this.setupTemplate(e),this.setupFeatureControllers())}storageKey(e){const t=e.properties?._WrappedId,i=e.variant_id;return(t||i).toString()}setupTemplate(t){Ie(this),this.element.style.display="",o.isFiltered(t.product_id)&&((0,e.debug)(this.identifier,`filtered product: ${t.product_id}`),this.element.style.display="none"),this.settings?.poweredBy||this.poweredByFeature?.remove()}setupFeatureControllers(){this.selectedOptionValue=n.m.getItem(this.keyValue,"selected"),this.refreshComponents()}refreshComponents(e=!1){this.element.setAttribute("is-checked",n.m.getItem(this.keyValue,"checked")),this.element.setAttribute("skip-render-update",this.skipComponentRenderUpdate(e)),this.element.setAttribute("selected-option-id",n.m.getItem(this.keyValue,"selected"));const t=(new Date).getTime();this.featureComponents.forEach((e=>{e?.setAttribute("refreshed-at",t)}))}skipComponentRenderUpdate(e){if(e)return!!this.settings.actionDelayRender||!(!this.settings.actionReload||this.settings.actionEvent||this.settings.actionFunction)||void 0}get featureComponents(){return[this.checkboxFeature,this.variantsFeature,this.messageFeature,this.senderReceiverFeature,this.poweredByFeature]}get checkboxFeature(){return this.element.querySelector("feature-checkbox")}get variantsFeature(){return this.element.querySelector("feature-variants")}get messageFeature(){return this.element.querySelector("feature-message")}get senderReceiverFeature(){return this.element.querySelector("feature-sender-recipient")}get poweredByFeature(){return this.element.querySelector("feature-powered-by")}},Ne=class extends Fe{static values={touchedAt:{type:Number,default:0},index:Number,key:String,selectedOption:Number,accountLimited:Boolean};initialize(){window.Wrapped.enabledWidgets[this.identifier]&&(window.Wrapped.settings.customer_filtered||((0,e.debug)(this.identifier,`init - ${this.indexValue}`),this.settings=F(this.identifier),this.accountLimitedValue=this.isAccountLimited(),Le(this.settings,this.element),this.element.addEventListener("giftOption:changed",this.giftOptionChanged.bind(this))))}connect(){(0,e.debug)(this.identifier,`conn - ${this.indexValue}`)}disconnect(){(0,e.debug)(this.identifier,`exit - ${this.indexValue}`),document.dispatchEvent(new CustomEvent("wrapped:cart:register",{detail:{identifier:this.identifier}})),document.dispatchEvent(new CustomEvent("wrapped:widget:setup"))}indexValueChanged(e,t){this.setupController()}touchedAtValueChanged(t,i){void 0!==t&&0!==t&&((0,e.debug)(this.identifier,`touched at: ${t}`),this.setupController())}isAccountLimited(){const e=new Date(window.Wrapped.settings.account_limited_on),t=new Date;return window.Wrapped.settings.account_limited&&e<t}giftOptionChanged(e){this.selectedOptionValue=e.detail.giftOptionId,e.detail.checked&&0!==Number(this.selectedOptionValue)||(n.m.removeItems(0),n.m.removeItems(this.keyValue)),document.dispatchEvent(new CustomEvent("wrapped:cart:items",{detail:{identifier:this.identifier}})),document.dispatchEvent(new CustomEvent("wrapped:variant:changed",{detail:{identifier:this.identifier,key:this.keyValue,selectedOption:this.selectedOptionValue}})),this.refreshComponents(!0)}async setupController(){if(!this.settings)return;const e=await $e.fetch(this);void 0!==e&&(this.keyValue=this.storageKey(e),this.element.setAttribute("is-checked",n.m.getItem(this.keyValue,"checked")),this.element.setAttribute("is-gift",a.isGift(e.variant_id)),this.element.setAttribute("widget-type","item"),this.element.setAttribute("storage-key",this.keyValue),this.element.setAttribute("selected-option-id",n.m.getItem(this.keyValue,"selected")),this.element.setAttribute("gift-option-id",e.variant_id),this.element.setAttribute("gift-option-filters",window.Wrapped.settings.filters[e.product_id]),this.element.setAttribute("hidden-checkbox",!1===this.settings.checkbox),this.element.setAttribute("selector-type",this.settings.variantSelector),this.element.setAttribute("message-enabled",this.settings.message),this.element.setAttribute("message-max-length",this.settings.messageMaxLength),this.element.setAttribute("sender-receiver-enabled",this.settings.senderReceiver),this.element.setAttribute("sender-receiver-fields",this.settings.senderReceiverFields),this.setupTemplate(e),this.setupFeatureControllers())}storageKey(e){const t=e.properties?._WrappedId,i=e.variant_id;return(t||i).toString()}setupTemplate(t){Ie(this),this.element.style.display="",o.isFiltered(t.product_id)&&((0,e.debug)(this.identifier,`filtered product: ${t.product_id}`),this.element.style.display="none"),this.settings?.poweredBy||this.poweredByFeature?.remove()}setupFeatureControllers(){this.selectedOptionValue=n.m.getItem(this.keyValue,"selected"),this.refreshComponents()}refreshComponents(e=!1){this.element.setAttribute("is-checked",n.m.getItem(this.keyValue,"checked")),this.element.setAttribute("skip-render-update",this.skipComponentRenderUpdate(e)),this.element.setAttribute("selected-option-id",n.m.getItem(this.keyValue,"selected"));const t=(new Date).getTime();this.featureComponents.forEach((e=>{e?.setAttribute("refreshed-at",t)}))}skipComponentRenderUpdate(e){if(e)return!!this.settings.actionDelayRender||!(!this.settings.actionReload||this.settings.actionEvent||this.settings.actionFunction)||void 0}get featureComponents(){return[this.checkboxFeature,this.variantsFeature,this.messageFeature,this.senderReceiverFeature,this.poweredByFeature]}get checkboxFeature(){return this.element.querySelector("feature-checkbox")}get variantsFeature(){return this.element.querySelector("feature-variants")}get messageFeature(){return this.element.querySelector("feature-message")}get senderReceiverFeature(){return this.element.querySelector("feature-sender-recipient")}get poweredByFeature(){return this.element.querySelector("feature-powered-by")}};let Ve=document.location.href;var Me=class extends Fe{static values={touchedAt:{type:Number,default:0},index:Number,key:String,selectedOption:Number,accountLimited:Boolean};initialize(){window.Wrapped.enabledWidgets[this.identifier]&&(window.Wrapped.settings.customer_filtered||void 0!==window.Wrapped.selectedProductId&&void 0!==window.Wrapped.selectedVariantId&&((0,e.debug)(this.identifier,`init - ${this.indexValue}`),this.settings=F(this.identifier),this.accountLimitedValue=this.isAccountLimited(),Le(this.settings,this.element),this.element.addEventListener("giftOption:changed",this.giftOptionChanged.bind(this))))}connect(){(0,e.debug)(this.identifier,`conn - ${this.indexValue}`),this.setupVariantListener()}disconnect(){(0,e.debug)(this.identifier,`exit - ${this.indexValue}`),document.dispatchEvent(new CustomEvent("wrapped:cart:register",{detail:{identifier:this.identifier}})),document.dispatchEvent(new CustomEvent("wrapped:widget:setup"))}indexValueChanged(e,t){this.setupController()}touchedAtValueChanged(t,i){void 0!==t&&0!==t&&((0,e.debug)(this.identifier,`controller touched at: ${t}`),this.setupController())}isAccountLimited(){const e=new Date(window.Wrapped.settings.account_limited_on),t=new Date;return window.Wrapped.settings.account_limited&&e<t}async giftOptionChanged(e){this.selectedOptionValue=e.detail.giftOptionId,e.detail.checked&&0!==Number(this.selectedOptionValue)||(n.m.removeItems(0),n.m.removeItems(this.keyValue)),document.dispatchEvent(new CustomEvent("wrapped:widget:refresh")),document.dispatchEvent(new CustomEvent("wrapped:cart:add_gift",{detail:{...e.detail,identifier:this.identifier}})),document.dispatchEvent(new CustomEvent("wrapped:variant:changed",{detail:{identifier:this.identifier,key:this.keyValue,selectedOption:this.selectedOptionValue}})),this.refreshComponents(!0)}setupController(){this.settings&&(this.keyValue=this.storageKey(),this.element.setAttribute("is-checked",n.m.getItem(this.keyValue,"checked")),this.element.setAttribute("is-gift",a.isGift(window.Wrapped.selectedVariantId)),this.element.setAttribute("widget-type","product"),this.element.setAttribute("storage-key",this.keyValue),this.element.setAttribute("selected-option-id",n.m.getItem(this.keyValue,"selected")),this.element.setAttribute("gift-option-id",window.Wrapped.selectedVariantId.toString()),this.element.setAttribute("gift-option-filters",window.Wrapped.settings.filters[window.Wrapped.selectedProductId]),this.element.setAttribute("hidden-checkbox",!1===this.settings.checkbox),this.element.setAttribute("selector-type",this.settings.variantSelector),this.element.setAttribute("message-enabled",this.settings.message),this.element.setAttribute("message-max-length",this.settings.messageMaxLength),this.element.setAttribute("sender-receiver-enabled",this.settings.senderReceiver),this.element.setAttribute("sender-receiver-fields",this.settings.senderReceiverFields),this.setupTemplate(),this.setupFeatureControllers())}storageKey(){let t;if(this.usesWrappedUniqueId){t=document.body.getAttribute("wrapped-unique-id")||window.crypto?.randomUUID().substring(0,8);const i=this.element.closest('form[action*="/cart/add"]')||document.querySelector('form[action*="/cart/add"]');if(i){const e=document.createElement("input");e.type="hidden",e.name="properties[_WrappedId]",e.value=t,i.appendChild(e),document.body.setAttribute("wrapped-unique-id",t)}else(0,e.error)(this.identifier,"unique-line-item property cannot be set as widget is not within add to cart form")}const i=window.Wrapped.selectedVariantId.toString();return(t||i).toString()}setupVariantListener(){this.settings&&new MutationObserver((()=>{if(document.location.href===Ve)return;Ve=document.location.href;const t=new URLSearchParams(document.location.search).get("variant");if(!t||window.Wrapped.selectedVariantId===t)return;const i=window.Wrapped.selectedVariantId;window.Wrapped.selectedVariantId=t,(0,e.debug)(this.identifier,`variant changed: ${i}->${t}`),this.setupFeatureControllers(),document.dispatchEvent(new CustomEvent("wrapped:widget:refresh"))})).observe(document.body,{childList:!0,subtree:!0})}setupTemplate(){Ie(this),this.element.style.display="",o.isFiltered(window.Wrapped.selectedProductId)&&((0,e.debug)(this.identifier,`filtered product: ${window.Wrapped.selectedProductId}`),this.element.style.display="none"),this.settings?.poweredBy||this.poweredByFeature?.remove()}setupFeatureControllers(){this.selectedOptionValue=n.m.getItem(this.keyValue,"selected"),this.refreshComponents()}refreshComponents(e=!1){this.element.setAttribute("is-checked",n.m.getItem(this.keyValue,"checked")),this.element.setAttribute("skip-render-update",this.skipComponentRenderUpdate(e)),this.element.setAttribute("selected-option-id",n.m.getItem(this.keyValue,"selected"));const t=(new Date).getTime();this.featureComponents.forEach((e=>{e?.setAttribute("refreshed-at",t)}))}skipComponentRenderUpdate(e){if(e)return!!this.settings.actionDelayRender||!(!this.settings.actionReload||this.settings.actionEvent||this.settings.actionFunction)||void 0}get usesWrappedUniqueId(){return!o.isFilteredProduct(window.Wrapped.selectedProductId)&&window.Wrapped.enabledFeatures["unique-line-items"]}get featureComponents(){return[this.checkboxFeature,this.variantsFeature,this.messageFeature,this.senderReceiverFeature,this.poweredByFeature]}get checkboxFeature(){return this.element.querySelector("feature-checkbox")}get variantsFeature(){return this.element.querySelector("feature-variants")}get messageFeature(){return this.element.querySelector("feature-message")}get senderReceiverFeature(){return this.element.querySelector("feature-sender-recipient")}get poweredByFeature(){return this.element.querySelector("feature-powered-by")}};i(9181),i(9577),i(3082),i(7579),i(1868),i(4258),window.Stimulus=class{constructor(e=document.documentElement,t=ve){this.logger=console,this.debug=!1,this.logDebugActivity=(e,t,i={})=>{this.debug&&this.logFormattedMessage(e,t,i)},this.element=e,this.schema=t,this.dispatcher=new S(this),this.router=new be(this),this.actionDescriptorFilters=Object.assign({},N)}static start(e,t){const i=new this(e,t);return i.start(),i}async start(){await new Promise((e=>{"loading"==document.readyState?document.addEventListener("DOMContentLoaded",(()=>e())):e()})),this.logDebugActivity("application","starting"),this.dispatcher.start(),this.router.start(),this.logDebugActivity("application","start")}stop(){this.logDebugActivity("application","stopping"),this.dispatcher.stop(),this.router.stop(),this.logDebugActivity("application","stop")}register(e,t){this.load({identifier:e,controllerConstructor:t})}registerActionOption(e,t){this.actionDescriptorFilters[e]=t}load(e,...t){(Array.isArray(e)?e:[e,...t]).forEach((e=>{e.controllerConstructor.shouldLoad&&this.router.loadDefinition(e)}))}unload(e,...t){(Array.isArray(e)?e:[e,...t]).forEach((e=>this.router.unloadIdentifier(e)))}get controllers(){return this.router.contexts.map((e=>e.controller))}getControllerForElementAndIdentifier(e,t){const i=this.router.getContextForElementAndIdentifier(e,t);return i?i.controller:null}handleError(e,t,i){var s;this.logger.error("%s\n\n%o\n\n%o",t,e,i),null===(s=window.onerror)||void 0===s||s.call(window,t,"",0,0,e)}logFormattedMessage(e,t,i={}){i=Object.assign({application:this},i),this.logger.groupCollapsed(`${e} #${t}`),this.logger.log("details:",Object.assign({},i)),this.logger.groupEnd()}}.start(),window.Stimulus.register("wrapped-cart",_e),window.Stimulus.register("wrapped-cart-drawer",Te),window.Stimulus.register("wrapped-item",Se),window.Stimulus.register("wrapped-item-drawer",Ne),window.Stimulus.register("wrapped-product",Me)}()}();
//# sourceMappingURL=app-embed.js.map